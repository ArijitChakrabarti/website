<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://kozodoi.me/feed.xml" rel="self" type="application/atom+xml" /><link href="https://kozodoi.me/" rel="alternate" type="text/html" /><updated>2020-08-01T02:37:43-05:00</updated><id>https://kozodoi.me/feed.xml</id><title type="html">Nikita Kozodoi</title><subtitle>Blog on ML, DS and other cool acronyms</subtitle><entry><title type="html">Data Mining Cup 2020 Solution</title><link href="https://kozodoi.me/python/time%20series/demand%20forecasting/competitions/2020/07/27/demand-forecasting.html" rel="alternate" type="text/html" title="Data Mining Cup 2020 Solution" /><published>2020-07-27T00:00:00-05:00</published><updated>2020-07-27T00:00:00-05:00</updated><id>https://kozodoi.me/python/time%20series/demand%20forecasting/competitions/2020/07/27/demand-forecasting</id><content type="html" xml:base="https://kozodoi.me/python/time%20series/demand%20forecasting/competitions/2020/07/27/demand-forecasting.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-27-demand-forecasting.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;1.-Overview&quot;&gt;1. Overview&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-Overview&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://www.data-mining-cup.com&quot;&gt;Data Mining Cup&lt;/a&gt; is an annual international machine learning competition. The 2020 edition was devoted to demand forecasting. Together with &lt;a href=&quot;https://www.linkedin.com/in/elizaveta-zinovyeva-4155a184/&quot;&gt;Elizaveta Zinovyeva&lt;/a&gt;, we represented the &lt;a href=&quot;https://www.hu-berlin.de/en?set_language=en&quot;&gt;Humboldt University of Berlin&lt;/a&gt; and finished in the top-15 of the leaderboard.&lt;/p&gt;
&lt;p&gt;Demand forecasting is an important task that helps to optimize inventory planning. The optimized stocks can reduce retailer's costs and increase customer satisfaction due to faster delivery time. The competition task was to predict demand for a set of items using past purchase data.&lt;/p&gt;
&lt;p&gt;This blogpost provides a detailed walkthrough covering the crucial steps of our solution:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;data preparation and feature engineering&lt;/li&gt;
&lt;li&gt;aggregation of transactional data into the daily format&lt;/li&gt;
&lt;li&gt;implementation of custom profit-driven loss functions&lt;/li&gt;
&lt;li&gt;two-stage demand forecasting with LightGBM&lt;/li&gt;
&lt;li&gt;hyper-parameter tuning with &lt;code&gt;hyperopt&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Feel free to jump directly to the parts that are interesting to you! The complete notebooks reproducing our solution are available &lt;a href=&quot;https://github.com/kozodoi/DMC_2020&quot;&gt;on Github&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;2.-Data-preparation&quot;&gt;2. Data preparation&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-Data-preparation&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Data-overview&quot;&gt;Data overview&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-overview&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The competition data consists of three data sets:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;infos.csv&lt;/code&gt;: prices and promotions in the unlabeled test set&lt;/li&gt;
&lt;li&gt;&lt;code&gt;items.csv&lt;/code&gt;: item-specific characteristics such as brand, manufacturer, etc&lt;/li&gt;
&lt;li&gt;&lt;code&gt;orders.csv&lt;/code&gt;: purchase transactions over the 6-month period&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let's have a look at the data:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# packages&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;seaborn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sns&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# data import&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;infos&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../data/raw/infos.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;|&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../data/raw/items.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;|&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../data/raw/orders.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;|&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;infos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(10463, 3)
(10463, 8)
(2181955, 5)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;infos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;itemID&lt;/th&gt;
      &lt;th&gt;simulationPrice&lt;/th&gt;
      &lt;th&gt;promotion&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3.43&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;9.15&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;14.04&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;14.10&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;7.48&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;itemID&lt;/th&gt;
      &lt;th&gt;brand&lt;/th&gt;
      &lt;th&gt;manufacturer&lt;/th&gt;
      &lt;th&gt;customerRating&lt;/th&gt;
      &lt;th&gt;category1&lt;/th&gt;
      &lt;th&gt;category2&lt;/th&gt;
      &lt;th&gt;category3&lt;/th&gt;
      &lt;th&gt;recommendedRetailPrice&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;4.38&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;8.84&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3.00&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;16.92&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;5.00&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;15.89&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4.44&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;40.17&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;2.33&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;17.04&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;time&lt;/th&gt;
      &lt;th&gt;transactID&lt;/th&gt;
      &lt;th&gt;itemID&lt;/th&gt;
      &lt;th&gt;order&lt;/th&gt;
      &lt;th&gt;salesPrice&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2018-01-01 00:01:56&lt;/td&gt;
      &lt;td&gt;2278968&lt;/td&gt;
      &lt;td&gt;450&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;17.42&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2018-01-01 00:01:56&lt;/td&gt;
      &lt;td&gt;2278968&lt;/td&gt;
      &lt;td&gt;83&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;5.19&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;2018-01-01 00:07:11&lt;/td&gt;
      &lt;td&gt;2255797&lt;/td&gt;
      &lt;td&gt;7851&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;20.47&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;2018-01-01 00:09:24&lt;/td&gt;
      &lt;td&gt;2278968&lt;/td&gt;
      &lt;td&gt;450&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;17.42&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;2018-01-01 00:09:24&lt;/td&gt;
      &lt;td&gt;2278968&lt;/td&gt;
      &lt;td&gt;83&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;5.19&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;For each of the 10,463 items, we need to predict the total number of orders in the 14-day period following the last day in &lt;code&gt;orders&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Preprocessing&quot;&gt;Preprocessing&lt;a class=&quot;anchor-link&quot; href=&quot;#Preprocessing&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's do some preprocessing! First, we merge &lt;code&gt;items&lt;/code&gt; and &lt;code&gt;infos&lt;/code&gt; that contain item-level data:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;infos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;infos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;infos&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(10463, 3)
(10463, 8)
(10463, 10)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Next, we check and convert feature types to the appropriate format:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtypes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtypes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# items&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;brand&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category3&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;str&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;object&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
    
&lt;span class=&quot;c1&quot;&gt;# orders&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;transactID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;str&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;object&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
    
&lt;span class=&quot;c1&quot;&gt;# dates&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;str&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;infer_datetime_format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;--------------------------------------------------
itemID                      int64
simulationPrice           float64
promotion                  object
brand                       int64
manufacturer                int64
customerRating            float64
category1                   int64
category2                   int64
category3                   int64
recommendedRetailPrice    float64
dtype: object
--------------------------------------------------
time           object
transactID      int64
itemID          int64
order           int64
salesPrice    float64
dtype: object
--------------------------------------------------
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Finally, we unfold the &lt;code&gt;promotion&lt;/code&gt; feature containing a sequence of coma-separated promotion dates. We use &lt;code&gt;split_nested_features()&lt;/code&gt; from &lt;code&gt;dptools&lt;/code&gt; to split a string column into separate features.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dptools&lt;/code&gt; is a package developed by me to simplify some of the common data preprocessing and feature engineering tasks. Below, you will see more examples on using &lt;code&gt;dptools&lt;/code&gt; for other applications. You can read more about the package &lt;a href=&quot;https://github.com/kozodoi/dptools&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# import packages&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;pip install dptools
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;dptools&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# split promotion feature&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;split_nested_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;split_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# convert dates&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;promotion_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;like&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion_&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;promotion_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;infer_datetime_format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Added 3 split-based features.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;itemID&lt;/th&gt;
      &lt;th&gt;simulationPrice&lt;/th&gt;
      &lt;th&gt;brand&lt;/th&gt;
      &lt;th&gt;manufacturer&lt;/th&gt;
      &lt;th&gt;customerRating&lt;/th&gt;
      &lt;th&gt;category1&lt;/th&gt;
      &lt;th&gt;category2&lt;/th&gt;
      &lt;th&gt;category3&lt;/th&gt;
      &lt;th&gt;recommendedRetailPrice&lt;/th&gt;
      &lt;th&gt;promotion_0&lt;/th&gt;
      &lt;th&gt;promotion_1&lt;/th&gt;
      &lt;th&gt;promotion_2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3.43&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;4.38&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;8.84&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;9.15&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3.00&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;16.92&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;14.04&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;5.00&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;15.89&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;14.10&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4.44&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;40.17&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;7.48&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;2.33&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;17.04&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can now export the data as csv. I use &lt;code&gt;save_csv_version()&lt;/code&gt; that automatically adds a version number to the file name to prevent overwriting the data after making changes in the code.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;save_csv_version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../data/prepared/orders.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;gzip&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;save_csv_version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../data/prepared/items.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;gzip&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Saved as ../data/prepared/orders_v2.csv
Saved as ../data/prepared/items_v2.csv
(2181955, 5)
(10463, 12)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;3.-Aggregation-and-feature-engineering&quot;&gt;3. Aggregation and feature engineering&lt;a class=&quot;anchor-link&quot; href=&quot;#3.-Aggregation-and-feature-engineering&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Data-aggregation&quot;&gt;Data aggregation&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-aggregation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's work with &lt;code&gt;orders&lt;/code&gt;, which is formatted as a list of transactions with timestamps. We need to aggregate this data in order to use it for the modeling.&lt;/p&gt;
&lt;p&gt;Since the task is a 14-day demand forecasting, a simple way forward would be to aggregate transactions on a two-week basis. However, this could lead to losing some more granular information. Instead, we aggregate transactions by day:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dayofyear&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orders_price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;salesPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;itemID&lt;/th&gt;
      &lt;th&gt;day_of_year&lt;/th&gt;
      &lt;th&gt;order&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;23&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;25&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;29&lt;/td&gt;
      &lt;td&gt;307&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;30&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;31&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Adding-missing-item-day-combinations&quot;&gt;Adding missing item-day combinations&lt;a class=&quot;anchor-link&quot; href=&quot;#Adding-missing-item-day-combinations&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The aggregated data only contains entries for day-item pairs for which there is at least one transaction. This results in missing information:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;most items are only sold on a few days; no data on days with no orders is recorded&lt;/li&gt;
&lt;li&gt;there are a few items that are never sold and therefore do not appear in &lt;code&gt;orders&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To account for the missing data, we add entries with &lt;code&gt;order = 0&lt;/code&gt; for missing day-item combinations including the items that were never sold. This increases the number of observations from 100,771 to 1,883,340 and provides useful information about zero sales.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# add items that were never sold before&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;missing_itemIDs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;missing_rows&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;missing_itemIDs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                            &lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;missing_itemIDs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;int&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                            &lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;missing_itemIDs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;int&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)})&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;missing_rows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# add zeros for days with no transactions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;order&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unstack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dropna&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fillna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(100771, 3)
(1883340, 3)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Labeling-promotions&quot;&gt;Labeling promotions&lt;a class=&quot;anchor-link&quot; href=&quot;#Labeling-promotions&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The documentation says that promotions in the training data are not explicitly marked.&lt;/p&gt;
&lt;p&gt;We need to manually mark promotion days. Ignoring it complicates forecasting because the number of orders in some days explodes without an apparent reason. In such cases, the underlying reason is likely to be a promotion, which should be reflected in a corresponding feature.&lt;/p&gt;
&lt;p&gt;We need to be very careful and conservative about marking promotions. Labeling too many days as promotions based on the number of orders risks introducing data leakage since the number of orders is unknown at the prediction time. Below, I use &lt;code&gt;find_peaks()&lt;/code&gt; to isolate peaks in the &lt;code&gt;order&lt;/code&gt; time series and encode them as promotions:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# computations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;itemID&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;promo&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;itemID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;avg&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;itemID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;median&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;itemID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;peaks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find_peaks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;itemID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;avg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# append avg to enable marking last point as promo&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;prominence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# peak difference with neighbor points; max(5,std) to exclude cases when std is too small&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;avg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# minimal height of a peak&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;promo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;peaks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;itemID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;promo&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# compare promotion number&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;promo_in_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;promo_in_test&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;promotion_0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isnull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;promotion_2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isnull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;promotion_1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isnull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Daily p(promotion) per item in train: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;promo_in_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Daily p(promotion) per item in test:  &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;promo_in_test&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Daily p(promotion) per item in train: 0.0079
Daily p(promotion) per item in test:  0.0141
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Our method identifies 14,911 promotions. Compared to the unlabeled test set where promotions are explicitly reported, this amounts to about twice as few promotions per item and day.&lt;/p&gt;
&lt;p&gt;Let's look at some items to check which observations are marked as promotions:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# compute promo count&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;promo_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;promo_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;promo_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plot some items&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;item_plots&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10462&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item_plots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itemID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;promo_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item_plots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Total Orders&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Day&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_promotions.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The yellow marker indicates promotions. Our method identifies some outliers as promotions but misses a few points that are less prominent. At the same time, we can not be sure that these cases are necessarily promotions: the large number of orders on these days could be observed due to other reasons. We will stick to this identification method but note that this aspect might require further improvement.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Feature-engineering&quot;&gt;Feature engineering&lt;a class=&quot;anchor-link&quot; href=&quot;#Feature-engineering&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now that the data is aggregated, we can construct transaction-based features as well as the targets. For each day, we compute target as the total number of orders in the following 14 days. The days preceeding the considered day are used to extract features. For each day, we extract slices of the past [1, 7, ..., 35] days and compute features based on data from that slice.&lt;/p&gt;
&lt;p&gt;For each item, we construct the following features:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the total count of orders and ordered items&lt;/li&gt;
&lt;li&gt;the total count of promotions&lt;/li&gt;
&lt;li&gt;mean item price&lt;/li&gt;
&lt;li&gt;recency of the last order&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The number of orders and promotions is also aggregated on a manufacturer and category level.&lt;/p&gt;
&lt;p&gt;In addition, we use &lt;code&gt;tsfresh&lt;/code&gt; package to automatically extract features based on the order dynamics in the last 35 days. &lt;code&gt;tsfresh&lt;/code&gt; computes hundreds of features describing the time series. We only keep features with no missing values for all day-item combinations.&lt;/p&gt;
&lt;p&gt;Finally, we compute features based on the two-week period for which we predict demand: the number of promotions and mean prices per item, manufacturer and category.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# packages&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tsfresh&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extract_features&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;days_input&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;days_target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# preparations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;day_first&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;days_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;day_last&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;days_target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# merge manufacturer and category&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# computations&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;149&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_last&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]):&lt;/span&gt;
                

    &lt;span class=&quot;c1&quot;&gt;###### VALIDAION: TARGET, PROMOTIONS, PRICES&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# day intervals&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;target_day_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;target_day_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;days_target&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# compute target and promo: labeled data&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# target and future promo&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                            &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                           &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# future price&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                               &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                              &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;salesPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;salesPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# merge manufacturer and category&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# future price per manufacturer&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                         &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                         &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;salesPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# future price per category&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                     &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                     &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;salesPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# future promo per manufacturer&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                         &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                         &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# future promo per category&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                     &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                     &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                       
        
    &lt;span class=&quot;c1&quot;&gt;# compute target and promo: unlabeled data&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# placeholders&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;                     &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itemID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;                     &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;              &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;simulationPrice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;               &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manufacturer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;                   &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;category&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

        
    &lt;span class=&quot;c1&quot;&gt;###### TRAINING: LAG-BASED FEATURES&lt;/span&gt;
            
    &lt;span class=&quot;c1&quot;&gt;# compute features&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;days_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# day intervals&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;input_day_min&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;input_day_max&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt;
    
        &lt;span class=&quot;c1&quot;&gt;# frequency, promo and price&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                 &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order_sum_last_&amp;#39;&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order_count_last_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_count_last_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_last_&amp;#39;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;salesPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;salesPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# frequency, promo per manufacturer&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                 &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;order_manufacturer_sum_last_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order_manufacturer_count_last_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_manufacturer_count_last_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
        &lt;span class=&quot;c1&quot;&gt;# frequency, promo per category&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                 &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;order_category_sum_last_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;       
        &lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order_category_count_last_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_category_count_last_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# frequency, promo per all items&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order_all_sum_last_&amp;#39;&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order_all_count_last_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_all_count_last_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# recency&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;days_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                                     &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;days_since_last_order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;max&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reindex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itemID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;days_since_last_order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fillna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
            
        &lt;span class=&quot;c1&quot;&gt;# tsfresh features&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;days_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;
                                      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg_orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_day_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;extracted_features&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extract_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;column_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;column_sort&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;extracted_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extracted_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extracted_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
            
    &lt;span class=&quot;c1&quot;&gt;###### FINAL PREPARATIONS&lt;/span&gt;
            
    &lt;span class=&quot;c1&quot;&gt;# add day of year&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;column&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# merge data&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# drop manufacturer and category&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;##### REMOVE MISSINGS&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;good_nas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
            &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nonas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isnull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;good_nas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nonas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;##### COMPUTE MEAN PRICE RATIOS&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;price_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_last_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_last_7&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_last_14&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
              &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_last_21&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_last_28&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_last_35&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;price_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ratio_&amp;#39;&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ratio_manufacturer_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ratio_category_&amp;#39;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(1391579, 458)
(1391579, 470)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The feature extraction takes about ten hours and outputs a data set with 470 features. Great job!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now, let's create features in the &lt;code&gt;items&lt;/code&gt; data frame:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ratio of the actual and recommended price&lt;/li&gt;
&lt;li&gt;item category index constructed of three subcategories&lt;/li&gt;
&lt;li&gt;customer rating realtive to the average rating of the items of the same manufacturer&lt;/li&gt;
&lt;li&gt;customer rating realtive to the average rating of the items of the same category&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# price ratio&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;recommended_simulation_price_ratio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;recommendedRetailPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# detailed item category&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category3&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# customer rating ratio per manufacturer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rating_manufacturer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;customerRating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rating_manufacturer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_customerRating_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rating_manufacturer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;customerRating_manufacturer_ratio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;customerRating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_customerRating_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_customerRating_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# customer rating ratio per category&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rating_category&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;customerRating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rating_category&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_customerRating_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rating_category&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;customerRating_category_ratio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;customerRating&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_customerRating_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_customerRating_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can now merge &lt;code&gt;orders&lt;/code&gt; and &lt;code&gt;items&lt;/code&gt;. We also partition the data into the labeled training set and the unlabeled test set, compute some missing features for the test set and export the data as csv.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;########## DATA PARTITIONING&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# merge data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# partition intro train and test&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;########## COMPUTE FEATURES FOR TEST DATA&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# add promotion info to test&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;promo_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;like&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promotion_&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;promo_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isnull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# future promo per manufacturer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# future promo per category&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# future price per manufacturer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_manufacturer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# future price per category&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;agg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_df_category&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;how&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# mean price ratios&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;price_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ratio_&amp;#39;&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ratio_manufacturer_&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ratio_category_&amp;#39;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;########## DROP FEATURES&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# drop promotion dates&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;promo_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;promo_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# drop mean prices&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;price_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;price_vars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_manufacturer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mean_price_test_category&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;price_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;price_vars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# export data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;save_csv_version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../data/prepared/df.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;gzip&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;save_csv_version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../data/prepared/df_test.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compression&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;gzip&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_version&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Saved as ../data/prepared/df_v14.csv
Saved as ../data/prepared/df_test_v14.csv
(1381116, 476)
(10463, 476)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;4.-Modeling&quot;&gt;4. Modeling&lt;a class=&quot;anchor-link&quot; href=&quot;#4.-Modeling&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Custom-loss-functions&quot;&gt;Custom loss functions&lt;a class=&quot;anchor-link&quot; href=&quot;#Custom-loss-functions&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Mahcine learning encompasses a wide range of statically-inspired performance metrics such as MSE, MAE and others. In practice, machine learning models are used by a company that has specific goals. Usually, these goals can not be expressed in terms of such simple metrics. Therefore, it is important to come up with an evaluation metric consistent with the company's objectives to ensure that we judge performance on a criterion that actually matters.&lt;/p&gt;
&lt;p&gt;In the DMC 2020 task, we are given a profit function of a retailer who is doing demand forecasting. The function accounts for asymmetric error costs: underpredicting demand results in lost revenue because the retailer can not sell a product that is not ready to ship, whereas overpredicting demand incurs a fee for storing the excessive amount of product.&lt;/p&gt;
&lt;p&gt;Below, we derive profit according to the task description:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_profit.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's implement the profit function in Python:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;profit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Computes profit according to DMC 2020 task.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Arguments:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - y_true (numpy array or list): ground truth (correct) target values.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - y_pred (numpy array or list): estimated target values.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - price (numpy array or list): item prices.&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    Returns:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - profit value&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# remove negative and round&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;int&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# sold units&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;units_sold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# overstocked units&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;units_overstock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;units_overstock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units_overstock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# profit&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;revenue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;units_sold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;price&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fee&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;units_overstock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.6&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;profit&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;revenue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fee&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;profit&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;profit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;profit&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The function above is great for evaluation. Can we go further and optimize it during modeling?&lt;/p&gt;
&lt;p&gt;We will use LightGBM which supports custom loss functions on training and validation stages. In order to use a custom loss on the the training stage, one needs to define a function with its first and second-order derivatives.&lt;/p&gt;
&lt;p&gt;A straightfoward approach would be to define the loss as a difference between the profit conditional on our demand prediction and oracle profit (when demand prediction is correct). However, such a loss would not be differentiable. This means that we could not compute derivatives to plug it as a training loss. Instead, we could come up with a slightly different function that approximates profit and satisfies the loss conditions.&lt;/p&gt;
&lt;p&gt;We define the loss as a squared difference between the oracle profit and profit based on predicted demand. In this setting, we can compute loss derivatives with respect to the prediction (Gradient and Hessian):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_loss.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The snippet below implements the training and validation losses for LightGBM. You can notice that we do not include the squared prices in the loss functions. The reason is that with &lt;code&gt;sklearn&lt;/code&gt; API, it is difficult to include external variables like prices in the loss.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# collpase-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;##### TRAINING LOSS&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;asymmetric_mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Asymmetric MSE objective for training LightGBM regressor.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;     &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Arguments:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - y_true (numpy array or list): ground truth (correct) target values.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - y_pred (numpy array or list): estimated target values.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Returns:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - gradient&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - hessian&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;residual&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;    
    &lt;span class=&quot;n&quot;&gt;grad&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;residual&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;residual&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.72&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;residual&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hess&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;residual&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.72&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hess&lt;/span&gt;



&lt;span class=&quot;c1&quot;&gt;##### VALIDATION LOSS&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;asymmetric_mse_eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Asymmetric MSE evaluation metric for LightGBM regressor.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;     &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Arguments:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - y_true (numpy array or list): ground truth (correct) target values.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - y_pred (numpy array or list): estimated target values.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Returns:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - metric name&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - metric value&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    - whether the metric is maximized&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;residual&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;      
    &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;where&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;residual&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;residual&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.72&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;residual&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;asymmetric_mse_eval&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;So how to deal with item prices?&lt;/p&gt;
&lt;p&gt;One option would be to account for prices within the &lt;code&gt;fit()&lt;/code&gt; method. LightGBM supports weighting observations on both training and validation stages using the arguments &lt;code&gt;sample_weight&lt;/code&gt; and &lt;code&gt;eval_sample_weight&lt;/code&gt;. You will see how we supply price vectors in the modeling code in the next section. Note that including prices as weights instead of plugging them into the loss leads to losing some information, since Gradients and Hessians are computed without the price multiplication. Still, this approach provides a pretty close approximation of the original profit-driven loss. If you are interested in including prices in the loss, you can check &lt;code&gt;lightGBM&lt;/code&gt; API that allows more flexibility.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The only missing piece is the relationship between the penalty size and the prediction error. By taking a square root of the profit differences instead of the absolute value, we penalize larger errors more than the smaller ones. However, our profit changes linearly with the error size. This is how we can can address it:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;transform target using a non-linear transofmration (e.g. square root)&lt;/li&gt;
&lt;li&gt;train a model that optimzes the MSE loss on the transformed target &lt;/li&gt;
&lt;li&gt;apply the inverse transformation to the model predictions&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Target transformation smooths out the square effect in MSE. We still penalize large errors more, but the large errors on a transformed scale are also smaller compared to the original scale. This helps to balance the two effects and approximate a linear relationship between the error size and the loss penalty.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Modeling-pipeline&quot;&gt;Modeling pipeline&lt;a class=&quot;anchor-link&quot; href=&quot;#Modeling-pipeline&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's start building models! First, we extract the target and flag ID features not used for prediction.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# extract target&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# format test data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_test&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# relevant features&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drop_feats&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;itemID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;features&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop_feats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(1381116, 475) (1381116,)
(10463, 475)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The modeling pipeline uses multiple tricks discovered during the model refinement process. We toogle these tricks using logical variables that define the following training options:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;target_transform = True&lt;/code&gt;: transforms target to reduce penalty for large errors. Motivation for this is provided in the previous section.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;train_on_positive = False&lt;/code&gt;: trains only on cases with positive sales (i.e., at least one of the order lags is greater than zero) and predicts null demand for items with no sales. This substantially reduces the training time but also leads to a drop in the performance.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;two_stage = True&lt;/code&gt;: trains a two-stage model: (i) binary classifier predicting whether the future sales will be zero; (ii) regression model predicting the volume of sales. Predictions of the regression model are only stored for cases where the classifier predicts positive sales.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tuned_params = True&lt;/code&gt;: imports optimized LightGBM hyper-parameter values. The next section describes the tuning procedure.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;##### TRAINING OPTIONS&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# target transformation&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# train on positive sales only&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_on_positive&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# two-stage model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;two_stage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# use tuned meta-params&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tuned_params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;##### CLASSIFIER PARAMETERS&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# rounds and options&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cores&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stop_rounds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# LGB parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;boosting_type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;s1&quot;&gt;&amp;#39;goss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;objective&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;asymmetric_mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;metrics&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;          &lt;span class=&quot;n&quot;&gt;asymmetric_mse_eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;n_estimators&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;learning_rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;bagging_fraction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;feature_fraction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;lambda_l1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;        &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;lambda_l2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;        &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;silent&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;           &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;verbosity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;nthread&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;cores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;random_state&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# load optimal parameters&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tuned_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;par_file&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../lgb_meta_params_100.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lgb_params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;par_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lgb_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;nthread&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cores&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lgb_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;random_state&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# second-stage LGB&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;two_stage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lgb_classifier_params&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lgb_params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lgb_classifier_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;objective&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;binary&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lgb_classifier_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;metrics&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;logloss&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We also define the partitioning parameters. We use a sliding window approach with 7 folds, where each subsequent fold is shifted by one day into the past.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;# no. CV folds&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_days&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# no. days in the test set&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's explain the partitioning using the first fold as an example. Each fold is divided into training and validation subsets. The first 35 days are cut off and only used to compute lag-based features for the days starting from 36. Days 36 - 145 are used for training. For each of these days, we have features based on the previous 35 days and targets based on the next 14 days. Days 159 - 173 are used for validation. Days 146 - 158 between training and validation subsets are skipped to avoid data leakage: the target for these days would use information from the validation period.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_partitioning.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can now set up a modeling loop with the following steps for each of the folds:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;extract data from the fold and partition it into training and validation sets&lt;/li&gt;
&lt;li&gt;train LightGBM on the training set and perform early stopping on the validation set&lt;/li&gt;
&lt;li&gt;save predictions for the validation set (denoted as OOF) and predictions for the test set&lt;/li&gt;
&lt;li&gt;save feature importance and performance on the validation fold&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# placeholders&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;importances&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;preds_oof&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;reals_oof&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prices_oof&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;preds_test&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;oof_rmse&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;oof_profit&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;oracle_profit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;clfs&lt;/span&gt;          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_idx&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# objects&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_days&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_days&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# no. days in the train set&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# modeling loop&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;##### PARTITIONING&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# dates&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;day_of_year&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_end&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_end&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;t_end&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_days&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;t_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_end&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_days&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# extract index&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;train_idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;   
    
    &lt;span class=&quot;c1&quot;&gt;# extract samples&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# keep positive cases&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_on_positive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order_sum_last_28&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order_sum_last_28&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# information&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;- train period days: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -- &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; (n = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;- valid period days: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -- &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; (n = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    
    &lt;span class=&quot;c1&quot;&gt;##### MODELING&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# target transformation&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# first stage model&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;two_stage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_train_binary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_valid_binary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_train_binary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train_binary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_valid_binary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_valid_binary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;clf_classifier&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lgb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LGBMClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lgb_classifier_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
        &lt;span class=&quot;n&quot;&gt;clf_classifier&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clf_classifier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train_binary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                            &lt;span class=&quot;n&quot;&gt;eval_set&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train_binary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_valid_binary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt;
                                            &lt;span class=&quot;n&quot;&gt;eval_metric&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;logloss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                            &lt;span class=&quot;n&quot;&gt;early_stopping_rounds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stop_rounds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                            &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;               &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;preds_oof_fold_binary&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clf_classifier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;preds_test_fold_binary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clf_classifier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# training&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lgb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LGBMRegressor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lgb_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                  &lt;span class=&quot;n&quot;&gt;eval_set&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; 
                  &lt;span class=&quot;n&quot;&gt;eval_metric&lt;/span&gt;           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;asymmetric_mse_eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                  &lt;span class=&quot;n&quot;&gt;sample_weight&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                  &lt;span class=&quot;n&quot;&gt;eval_sample_weight&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                  &lt;span class=&quot;n&quot;&gt;early_stopping_rounds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stop_rounds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                  &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;               &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;clfs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# inference&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;      
        &lt;span class=&quot;n&quot;&gt;preds_oof_fold&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;postprocess_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reals_oof_fold&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;preds_test_fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;postprocess_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;preds_oof_fold&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;postprocess_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reals_oof_fold&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;preds_test_fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;postprocess_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# impute zeros&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_on_positive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;preds_oof_fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order_sum_last_28&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;preds_test_fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;order_sum_last_28&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;promo_in_test&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# multiply with first stage predictions&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;two_stage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;preds_oof_fold&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds_oof_fold&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preds_oof_fold_binary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;preds_test_fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds_test_fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preds_test_fold_binary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# write predictions&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;preds_oof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds_oof_fold&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;reals_oof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reals_oof_fold&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;preds_test&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds_test_fold&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# save prices&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;prices_oof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;
        
        
    &lt;span class=&quot;c1&quot;&gt;##### EVALUATION&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# evaluation&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;oof_rmse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean_squared_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reals_oof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; 
                                               &lt;span class=&quot;n&quot;&gt;preds_oof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:])))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;oof_profit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reals_oof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; 
                             &lt;span class=&quot;n&quot;&gt;preds_oof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; 
                             &lt;span class=&quot;n&quot;&gt;price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;oracle_profit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reals_oof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; 
                                &lt;span class=&quot;n&quot;&gt;reals_oof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; 
                                &lt;span class=&quot;n&quot;&gt;price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# feature importance&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold_importance_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold_importance_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Feature&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold_importance_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Importance&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feature_importances_&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold_importance_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Fold&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;importances&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;importances&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold_importance_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# information&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;FOLD &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:d}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:d}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;: RMSE = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;, PROFIT = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.0f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                                                  &lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                                                  &lt;span class=&quot;n&quot;&gt;oof_rmse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                                                                  &lt;span class=&quot;n&quot;&gt;oof_profit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    

&lt;span class=&quot;c1&quot;&gt;# print performance&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;- AVERAGE RMSE:   &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oof_rmse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;- AVERAGE PROFIT: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.0f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; (&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;%)&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oof_profit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oof_profit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oracle_profit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;- RUNNING TIME:   &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; minutes&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;-----------------------------------------------------------------
- train period days: 41 -- 151 (n = 1161393)
- valid period days: 166 -- 166 (n = 10463)
-----------------------------------------------------------------
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[532]	training&amp;#39;s binary_logloss: 0.238417	valid_1&amp;#39;s binary_logloss: 0.347182
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[788]	training&amp;#39;s rmse: 0.611924	training&amp;#39;s asymmetric_mse_eval: 2.82734	valid_1&amp;#39;s rmse: 0.98004	valid_1&amp;#39;s asymmetric_mse_eval: 5.83945
-----------------------------------------------------------------
FOLD 1/7: RMSE = 74.46, PROFIT = 4146664
-----------------------------------------------------------------

-----------------------------------------------------------------
- train period days: 40 -- 150 (n = 1161393)
- valid period days: 165 -- 165 (n = 10463)
-----------------------------------------------------------------
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[1022]	training&amp;#39;s binary_logloss: 0.216471	valid_1&amp;#39;s binary_logloss: 0.345619
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[901]	training&amp;#39;s rmse: 0.599668	training&amp;#39;s asymmetric_mse_eval: 2.75637	valid_1&amp;#39;s rmse: 0.94857	valid_1&amp;#39;s asymmetric_mse_eval: 5.49861
-----------------------------------------------------------------
FOLD 2/7: RMSE = 71.49, PROFIT = 4085941
-----------------------------------------------------------------

-----------------------------------------------------------------
- train period days: 39 -- 149 (n = 1161393)
- valid period days: 164 -- 164 (n = 10463)
-----------------------------------------------------------------
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[643]	training&amp;#39;s binary_logloss: 0.230494	valid_1&amp;#39;s binary_logloss: 0.347911
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[699]	training&amp;#39;s rmse: 0.620079	training&amp;#39;s asymmetric_mse_eval: 2.87369	valid_1&amp;#39;s rmse: 0.954063	valid_1&amp;#39;s asymmetric_mse_eval: 5.44372
-----------------------------------------------------------------
FOLD 3/7: RMSE = 69.23, PROFIT = 4100618
-----------------------------------------------------------------

-----------------------------------------------------------------
- train period days: 38 -- 148 (n = 1161393)
- valid period days: 163 -- 163 (n = 10463)
-----------------------------------------------------------------
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[676]	training&amp;#39;s binary_logloss: 0.227568	valid_1&amp;#39;s binary_logloss: 0.351372
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[547]	training&amp;#39;s rmse: 0.645373	training&amp;#39;s asymmetric_mse_eval: 3.09249	valid_1&amp;#39;s rmse: 0.958953	valid_1&amp;#39;s asymmetric_mse_eval: 5.33328
-----------------------------------------------------------------
FOLD 4/7: RMSE = 68.55, PROFIT = 4009929
-----------------------------------------------------------------

-----------------------------------------------------------------
- train period days: 37 -- 147 (n = 1161393)
- valid period days: 162 -- 162 (n = 10463)
-----------------------------------------------------------------
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[552]	training&amp;#39;s binary_logloss: 0.231805	valid_1&amp;#39;s binary_logloss: 0.354317
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[788]	training&amp;#39;s rmse: 0.603891	training&amp;#39;s asymmetric_mse_eval: 2.76021	valid_1&amp;#39;s rmse: 0.943618	valid_1&amp;#39;s asymmetric_mse_eval: 5.01711
-----------------------------------------------------------------
FOLD 5/7: RMSE = 62.10, PROFIT = 3946376
-----------------------------------------------------------------

-----------------------------------------------------------------
- train period days: 36 -- 146 (n = 1161393)
- valid period days: 161 -- 161 (n = 10463)
-----------------------------------------------------------------
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[711]	training&amp;#39;s binary_logloss: 0.223124	valid_1&amp;#39;s binary_logloss: 0.349099
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[593]	training&amp;#39;s rmse: 0.631258	training&amp;#39;s asymmetric_mse_eval: 2.96402	valid_1&amp;#39;s rmse: 0.957476	valid_1&amp;#39;s asymmetric_mse_eval: 5.36804
-----------------------------------------------------------------
FOLD 6/7: RMSE = 67.31, PROFIT = 3735558
-----------------------------------------------------------------

-----------------------------------------------------------------
- train period days: 35 -- 145 (n = 1161393)
- valid period days: 160 -- 160 (n = 10463)
-----------------------------------------------------------------
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[711]	training&amp;#39;s binary_logloss: 0.22193	valid_1&amp;#39;s binary_logloss: 0.338637
Training until validation scores don&amp;#39;t improve for 100 rounds
Early stopping, best iteration is:
[782]	training&amp;#39;s rmse: 0.600011	training&amp;#39;s asymmetric_mse_eval: 2.71385	valid_1&amp;#39;s rmse: 0.987073	valid_1&amp;#39;s asymmetric_mse_eval: 5.67223
-----------------------------------------------------------------
FOLD 7/7: RMSE = 74.46, PROFIT = 3958098
-----------------------------------------------------------------


-----------------------------------------------------------------
- AVERAGE RMSE:   69.66
- AVERAGE PROFIT: 3997598 (54.19%)
- RUNNING TIME:   88.53 minutes
-----------------------------------------------------------------
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Looks good! The modeling pipeline took us about 1.5 hours to run.&lt;/p&gt;
&lt;p&gt;Forecasting demand with our models results in 3,997,598 daily profit, which is about 54% of the maximum possible profit. Let's visualize the results:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# collapse-hide&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# residual plot&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reals_oof&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds_oof&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axis_lim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reals_oof&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds_oof&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;top&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.02&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis_lim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.02&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis_lim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis_lim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis_lim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r--&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Residual Plot&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Predicted demand&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Actual demand&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# feature importance&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;top_feats&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;importances&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Feature&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Importance&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Feature&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Importance&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ascending&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;top_feats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;importance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;importances&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;importances&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Feature&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;barplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Importance&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Feature&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;importance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Importance&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ascending&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ci&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Feature Importance&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tight_layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_lgb_perf.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The scatterplot shows that there is a space for further improvement: many predictions are far from the 45-degree line where predicted and real orders are equal. The important features mostly contain price information followed by features that count the previous orders.&lt;/p&gt;
&lt;p&gt;We can now use predictions stored in &lt;code&gt;preds_test&lt;/code&gt; to create a submission. Mission acomplished!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;5.-Hyper-parameter-tuning&quot;&gt;5. Hyper-parameter tuning&lt;a class=&quot;anchor-link&quot; href=&quot;#5.-Hyper-parameter-tuning&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;One way to improve our solution is to optimize the LightGBM hyper-parameters.&lt;/p&gt;
&lt;p&gt;We tune hyper-parameters using the &lt;code&gt;hyperopt&lt;/code&gt; package, which performs optimization using Tree of Parzen Estimators (TPE) as a search algorithm. You don't really need to know how TPE works. As a user, you are only required to supply a parameter grid indicating the range of possible values. Compared to standard tuning methods like grid search or random search, TPE explores the search space more efficiently, allowing you to find a suitable solution faster. If you want to read more, see the package documentation &lt;a href=&quot;http://hyperopt.github.io/hyperopt/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So, let's specify hyper-parameter ranges! We create a dictionary using the following options:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;hp.choice('name', list_of_values)&lt;/code&gt;: sets a hyper-parameter to one of the values from a list. This is suitable for hyper-parameters that can have multiple distinct values like &lt;code&gt;boosting_type&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;hp.uniform('name', min, max)&lt;/code&gt;: sets a hyper-parameter to a float between &lt;code&gt;min&lt;/code&gt; and &lt;code&gt;max&lt;/code&gt;. This works well with hyper-parameters such as &lt;code&gt;learning_rate&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;hp.quniform('name', min, max, step)&lt;/code&gt;: sets a hyper-parameter to a value between &lt;code&gt;min&lt;/code&gt; and &lt;code&gt;max&lt;/code&gt; with a step size of &lt;code&gt;step&lt;/code&gt;. This is useful for integer parameters like &lt;code&gt;max_depth&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# training params&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;    
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;boosting_type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;hp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;boosting_type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gbdt&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;goss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;    
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;objective&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;        &lt;span class=&quot;s1&quot;&gt;&amp;#39;rmse&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;metrics&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;          &lt;span class=&quot;s1&quot;&gt;&amp;#39;rmse&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;n_estimators&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;learning_rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;hp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;learning_rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.0001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;max_depth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;hp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;quniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;max_depth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;          &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;num_leaves&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;hp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;quniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;num_leaves&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;        &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;bagging_fraction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;bagging_fraction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;feature_fraction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;feature_fraction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;lambda_l1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;hp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;lambda_l1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;           &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;lambda_l2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;hp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;lambda_l2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;           &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;silent&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;           &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;verbosity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;nthread&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;         &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;random_state&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;mi&quot;&gt;77&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# evaluation params&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_fit_params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;eval_metric&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;           &lt;span class=&quot;s1&quot;&gt;&amp;#39;rmse&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;early_stopping_rounds&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;verbose&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;               &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# combine params&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_space&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_space&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;reg_params&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_space&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;fit_params&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lgb_fit_params&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Next, we create &lt;code&gt;HPOpt&lt;/code&gt; object that performs tuning. We can avoid this in a simple tuning task, but defining an object gives us more control of the optimization process, which is useful with a custom loss. We define three object methods:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;process&lt;/code&gt;: runs optimization. By default, &lt;code&gt;HPO&lt;/code&gt; uses &lt;code&gt;fmin()&lt;/code&gt; to minimize the specified loss&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lgb_reg&lt;/code&gt;: initializes LightGBM model&lt;/li&gt;
&lt;li&gt;&lt;code&gt;train_reg&lt;/code&gt;: trains LightGBM and computes the loss. Since we aim to maximize profit, we simply define loss as negative profit&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# collapse-show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HPOpt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# INIT&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# optimization process&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fn_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;space&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;algo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_evals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fn_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fn&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                          &lt;span class=&quot;n&quot;&gt;space&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;space&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                          &lt;span class=&quot;n&quot;&gt;algo&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;algo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                          &lt;span class=&quot;n&quot;&gt;max_evals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_evals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                          &lt;span class=&quot;n&quot;&gt;trials&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;status&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STATUS_FAIL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;exception&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trials&lt;/span&gt;
    
    
    &lt;span class=&quot;c1&quot;&gt;# LGBM initialization&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;lgb_reg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;para&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;para&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;reg_params&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;max_depth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;para&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;reg_params&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;max_depth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;para&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;reg_params&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;num_leaves&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;para&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;reg_params&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;num_leaves&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lgb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LGBMRegressor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;para&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;reg_params&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_reg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;para&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    
    &lt;span class=&quot;c1&quot;&gt;# training and inference&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_reg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;para&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# fit LGBM&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;eval_set&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; 
                &lt;span class=&quot;n&quot;&gt;sample_weight&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;eval_sample_weight&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;para&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;fit_params&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# inference&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;      
            &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;postprocess_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;reals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;postprocess_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;reals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# compute loss [negative profit]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;profit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;price&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;simulationPrice&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
                      
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;status&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;STATUS_OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;To prevent overfitting, we perform tuning on a differet subset of data compared to the models trained in the previous section by going one day further in the past.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# validation dates&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;v_end&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;158&lt;/span&gt;          &lt;span class=&quot;c1&quot;&gt;# 1 day before last validation fold in code_03_modeling&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;v_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_end&lt;/span&gt;        &lt;span class=&quot;c1&quot;&gt;# same as v_start&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# training dates&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;t_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;           &lt;span class=&quot;c1&quot;&gt;# first day in the data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;t_end&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# validation day - two weeks&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# extract index&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day_of_year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   

&lt;span class=&quot;c1&quot;&gt;# extract samples&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# target transformation&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# information&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;- train period days: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -- &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; (n = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;- valid period days: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -- &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; (n = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;-----------------------------------------------------------------
- train period days: 28 -- 143 (n = 1213708)
- valid period days: 158 -- 158 (n = 10463)
-----------------------------------------------------------------
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now, we just need to instantiate the &lt;code&gt;HPOpt&lt;/code&gt; object and launch the tuning trials! The optimization will run automatically, and we would only need to extract the optimized values:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# instantiate objects&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hpo_obj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HPOpt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;trials&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Trials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;# perform tuning&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_opt_params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hpo_obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fn_name&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;lgb_reg&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;space&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lgb_space&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                 &lt;span class=&quot;n&quot;&gt;trials&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                 &lt;span class=&quot;n&quot;&gt;algo&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tpe&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;suggest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                 &lt;span class=&quot;n&quot;&gt;max_evals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tuning_trials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  

&lt;span class=&quot;c1&quot;&gt;# merge best params to fixed params&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lgb_opt_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;par_id&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;par_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lgb_opt_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;par_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# postprocess&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;boosting_type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boost_types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;boosting_type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;max_depth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;max_depth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;num_leaves&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;num_leaves&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# print best params&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Best meta-parameters:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Best meta-parameters:
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;{&amp;#39;boosting_type&amp;#39;: &amp;#39;goss&amp;#39;,
 &amp;#39;objective&amp;#39;: &amp;#39;rmse&amp;#39;,
 &amp;#39;metrics&amp;#39;: &amp;#39;rmse&amp;#39;,
 &amp;#39;n_estimators&amp;#39;: 10000,
 &amp;#39;learning_rate&amp;#39;: 0.004012417857266637,
 &amp;#39;max_depth&amp;#39;: 10,
 &amp;#39;num_leaves&amp;#39;: 64,
 &amp;#39;bagging_fraction&amp;#39;: 0.9346881591116736,
 &amp;#39;feature_fraction&amp;#39;: 0.6680768850934483,
 &amp;#39;lambda_l1&amp;#39;: 0.28013320828944976,
 &amp;#39;lambda_l2&amp;#39;: 0.5896826524767101,
 &amp;#39;silent&amp;#39;: True,
 &amp;#39;verbosity&amp;#39;: -1,
 &amp;#39;nthread&amp;#39;: 4,
 &amp;#39;random_state&amp;#39;: 77}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Done! Now we can save the optimized values and import them when setting up the model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# collapse-hide&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;par_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../lgb_meta_params.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lgb_reg_params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;par_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;par_file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;6.-Closing-words&quot;&gt;6. Closing words&lt;a class=&quot;anchor-link&quot; href=&quot;#6.-Closing-words&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This blogpost has finally come to an end. Thank you for reading!&lt;/p&gt;
&lt;p&gt;We looked at important stages of our solution and covered steps such as data aggregation, feature engineering, custom loss functions, target transformation and hyper-parameter tuning.&lt;/p&gt;
&lt;p&gt;Our final solution was a simple ensemble of multiple LightGBM models with different features and training options discussed in this post. If you are interested in the ensembling part, you can find the codes in my &lt;a href=&quot;https://github.com/kozodoi/DMC_2020&quot;&gt;Github&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Please feel free to use the comment widnow below to ask questions and stay tuned for the next editions of &lt;a href=&quot;https://www.data-mining-cup.com&quot;&gt;Data Mining Cup&lt;/a&gt;!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Nikita Kozodoi</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://kozodoi.me/images/posts/demand.png" /><media:content medium="image" url="https://kozodoi.me/images/posts/demand.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Detecting Blindness with Deep Learning</title><link href="https://kozodoi.me/python/deep%20learning/computer%20vision/competitions/2020/07/11/blindness-detection.html" rel="alternate" type="text/html" title="Detecting Blindness with Deep Learning" /><published>2020-07-11T00:00:00-05:00</published><updated>2020-07-11T00:00:00-05:00</updated><id>https://kozodoi.me/python/deep%20learning/computer%20vision/competitions/2020/07/11/blindness-detection</id><content type="html" xml:base="https://kozodoi.me/python/deep%20learning/computer%20vision/competitions/2020/07/11/blindness-detection.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-11-blindness-detection.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;1.-Overview&quot;&gt;1. Overview&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-Overview&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Can deep learning help to detect blindness?&lt;/p&gt;
&lt;p&gt;This blogpost describes a project that develops a convolutional neural network (CNN) for predicting the severity of the diabetic retinopathy based on the patient's retina photos. The project was completed within the scope of the &lt;a href=&quot;https://confirm.udacity.com/LMMJDA7C&quot;&gt;Udacity ML Engineer&lt;/a&gt; nano-degree program and the &lt;a href=&quot;https://www.kaggle.com/c/aptos2019-blindness-detection/data&quot;&gt;Kaggle competition&lt;/a&gt; hosted by the Asia Pacific Tele-Ophthalmology Society (APTOS).&lt;/p&gt;
&lt;p&gt;The blogpost provides a project walkthrough covering the following steps:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;data exploration and image preprocessing to normalize images from different clinics&lt;/li&gt;
&lt;li&gt;using transfer learning to pre-train CNN on a larger data set&lt;/li&gt;
&lt;li&gt;employing techniques such as learning rate scheduler, test-time augmentation and others&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The modeling is performed in &lt;code&gt;PyTorch&lt;/code&gt;. All notebooks and a PDF report are available &lt;a href=&quot;https://github.com/kozodoi/Udacity_Blindness_Detection&quot;&gt;on Github&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;2.-Motivation&quot;&gt;2. Motivation&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-Motivation&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Diabetic retinopathy (DR) is one of the leading causes of vision loss. The World Health Organization reports that more than 300 million people worldwide have diabetes (Wong et al. 2016). In 2019, the global prevalence of DR among individuals with diabetes was at more than 25% (Thomas et al. 2019). The prevalence has been rising rapidly in developing countries.&lt;/p&gt;
&lt;p&gt;Early detection and treatment are crucial steps towards preventing DR. The screening procedure requires a trained clinical expert to examine the fundus photographs of the patient's retina. This creates delays in diagnosis and treatment. This is especially relevant for developing countries, which often lack qualified medical staff to perform the diagnosis. Automated detection of DR can speed up the efficiency and coverage of the screening programs.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_retina.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Image source: &lt;a href=&quot;https://www.eyeops.com/contents/our-services/eye-diseases/diabetic-retinopathy&quot;&gt;https://www.eyeops.com/contents/our-services/eye-diseases/diabetic-retinopathy&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;3.-Data-preparation&quot;&gt;3. Data preparation&lt;a class=&quot;anchor-link&quot; href=&quot;#3.-Data-preparation&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Data preparation is a very important step that is frequently underestimated. The quality of the input data has a strong impact on the resulting performance of the developed machine learning models. Therefore, it is crucial to take some time to look at the data and think about possible issues that should be addressed before moving on to the modeling stage. Let's do that!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Data-exploration&quot;&gt;Data exploration&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-exploration&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The data set is available for the download at the &lt;a href=&quot;https://www.kaggle.com/c/aptos2019-blindness-detection/data&quot;&gt;competition's website&lt;/a&gt;. The data includes 3,662 labeled retina images of clinical patients and a test set with 1,928 images with unknown labels.&lt;/p&gt;
&lt;p&gt;The images are labeled by a clinical expert. The integer labels indicate the severity of DR on a scale from 0 to 4, where 0 indicates no disease and 5 is the proliferative stage of DR.&lt;/p&gt;
&lt;p&gt;Let's start by importing the data and looking at the class distribution.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;############ PACKAGES&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torchvision&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torchvision&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.utils.data&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PIL&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImageFile&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ImageFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LOAD_TRUNCATED_IMAGES&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cv2&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tqdm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm_notebook&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;seaborn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sns&lt;/span&gt;



&lt;span class=&quot;c1&quot;&gt;########## SETTINGS&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;display.max_columns&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;warnings&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;warnings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filterwarnings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;



&lt;span class=&quot;c1&quot;&gt;############ CLASS DISTRIBUTION&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# import data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/aptos2019-blindness-detection/train.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/aptos2019-blindness-detection/sample_submission.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plot&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Class Distribution&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of examples&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The data is imbalanced: 49% images are from healthy patients. The remaining 51% are different stages of DR. The least common class is 3 (severe stage) with only 5% of the total examples.&lt;/p&gt;
&lt;p&gt;The data is collected from multiple clinics using a variety of camera models, which creates discrepancies in the image resolution, aspect ratio and other parameters. This is demonstrated in the snippet below, where we plot histograms of image width, height and aspect ratio.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# placeholder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;image_stats&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# import loop&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;observation&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iterrows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# import image&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/aptos2019-blindness-detection/train_images/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.png&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;observation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;id_code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# compute stats&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;channels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ratio&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# save&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image_stats&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;observation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;channels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ratio&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# construct DF&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;image_stats&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_stats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;image_stats&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;height&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;width&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;channels&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ratio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# create plot &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# width&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_stats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;width&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;(a) Image Width&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of examples&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Width&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# height&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_stats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;height&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;(b) Image Height&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of examples&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Height&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ratio&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_stats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ratio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;(c) Aspect Ratio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of examples&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Ratio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now, let's look into the actual eyes! The code below creates the &lt;code&gt;EyeData&lt;/code&gt; dataset class to import images. We also create a &lt;code&gt;DataLoader&lt;/code&gt; object to load sample images and visualize the first batch.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;##### DATASET&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# image preprocessing&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;prepare_image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# import&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cvtColor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;COLOR_BGR2RGB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# resize&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# convert to tensor    &lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;
   
&lt;span class=&quot;c1&quot;&gt;# dataset&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;EyeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# initialize&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# length&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# get items    &lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__getitem__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;img_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;id_code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;.png&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prepare_image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    
&lt;span class=&quot;c1&quot;&gt;##### EXAMINE SAMPLE BATCH&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# transformations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sample_trans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToPILImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                  &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EyeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                 &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/aptos2019-blindness-detection/train_images&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_trans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# data loader&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sample_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                            &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                            &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                            &lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# display images&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# extract data&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# create plot&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yticks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt;     
        &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_eye_example.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The illustration further emphasizes differences in the aspect ratio and lighting conditions.&lt;/p&gt;
&lt;p&gt;The severity of DR is diagnosed by the presence of visual cues such as abnormal blood vessels, hard exudates and so-called cotton wool spots. You can read more about the diagnosing process &lt;a href=&quot;https://www.eyeops.com/contents/our-services/eye-diseases/diabetic-retinopathy&quot;&gt;here&lt;/a&gt;. Comparing the sample images, we can see the presence of exudates and cotton wool spots on some of the retina images of sick patients.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Image-preprocessing&quot;&gt;Image preprocessing&lt;a class=&quot;anchor-link&quot; href=&quot;#Image-preprocessing&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;To simplify the classification task for our model, we need to ensure that retina images look similar.&lt;/p&gt;
&lt;p&gt;First, using cameras with different aspect ratios results in some images having large black areas around the eye. The black areas do not contain information relevant for prediction and can be cropped. However, the size of black areas varies from one image to another. To address this, we develop a cropping function that converts the image to grayscale and marks black areas based on the pixel intensity. Next, we find a mask of the image by selecting rows and columns in which all pixels exceed the intensity threshold. This helps to remove vertical or horizontal rectangles filled with black similar to the ones observed in the upper-right image. After removing the black stripes, we resize the images to the same height and width.&lt;/p&gt;
&lt;p&gt;Another issue is the eye shape. Depending on the image parameters, some eyes have a circular form, whereas others look like ovals. Since the size and shape of cues located in the retina determine the disease severity, it is crucial to standardize the eye shape as well. To do so, we develop another function that makes a circular crop around the center of the image.&lt;/p&gt;
&lt;p&gt;Finally, we correct for the lightning and brightness discrepancies by smoothing the images using a Gaussian filter.&lt;/p&gt;
&lt;p&gt;The snippet below provides the updated &lt;code&gt;prepare_image()&lt;/code&gt; function that incorporates the discussed preprocessing steps.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;##### image preprocessing function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;prepare_image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigmaX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_random_crop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# import image&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imread&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cvtColor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;COLOR_BGR2RGB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# perform smart crops&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;crop_black&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_random_crop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_crop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# resize and color&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addWeighted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GaussianBlur&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigmaX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# circular crop&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;circle_crop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigmaX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigmaX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# convert to tensor    &lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;##### automatic crop of black areas&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;crop_black&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ndim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tol&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ix_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ndim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;gray_img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cvtColor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;COLOR_RGB2GRAY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gray_img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tol&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;check_shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ix_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;check_shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; 
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;img1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ix_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;img2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ix_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;img3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ix_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;
        
        
&lt;span class=&quot;c1&quot;&gt;##### circular crop around image center&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;circle_crop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sigmaX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;   
        
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;depth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;largest_side&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;largest_side&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;largest_side&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;depth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;circle_img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uint8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;circle_img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thickness&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bitwise_and&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;circle_img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; 


&lt;span class=&quot;c1&quot;&gt;##### random crop&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;random_crop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;depth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uniform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cut&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;    
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Next, we define a new &lt;code&gt;EyeData&lt;/code&gt; class that uses the new processing functions and visualize a batch of sample images after corrections.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;##### DATASET&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# dataset class&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;EyeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# initialize&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# length&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# get items    &lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__getitem__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;img_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;id_code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;.png&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prepare_image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;##### EXAMINE SAMPLE BATCH&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# transformations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sample_trans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToPILImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                  &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EyeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                 &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/aptos2019-blindness-detection/train_images&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_trans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# data loader&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sample_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                            &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                            &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                            &lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# display images&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# extract data&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# create plot&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yticks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt;     
        &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_eye_fixed.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This looks much better! Comparing the retina images to the ones before the preprocessing, we can see that the apparent discrepancies between the photos are now fixed. The eyes now have a similar circular shape, and the color scheme is more consistent. This should help the model to detect the signs of the DR.&lt;/p&gt;
&lt;p&gt;Check out &lt;a href=&quot;https://www.kaggle.com/ratthachat/aptos-eye-preprocessing-in-diabetic-retinopathy&quot;&gt;this notebook&lt;/a&gt; by Nakhon Ratchasima for more ideas on the image preprocessing for retina photos. The functions in this project are largely inspired by his work during the competition.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;4.-Modeling&quot;&gt;4. Modeling&lt;a class=&quot;anchor-link&quot; href=&quot;#4.-Modeling&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;CNNs achieve state-of-the-art performance in computer vision tasks. Recent medical research also shows a high potential of CNNs in DR classification (Gulshan et al. 2016).&lt;/p&gt;
&lt;p&gt;In this project, we employ a CNN model with the EfficientNet architecture. &lt;a href=&quot;https://arxiv.org/abs/1905.11946&quot;&gt;EfficientNet&lt;/a&gt; is one of the recent state-of-the-art image classification models (Tan et al. 2019). It encompasses 8 architecture variants (B0 to B7) that differ in the model complexity and default image size.&lt;/p&gt;
&lt;p&gt;The architecture of EfficientNet B0 is visualized below. We test multiple EfficientNet architectures and use the one that demonstrates the best performance.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_imagenet.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The modeling pipeline consists of three stages:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Pre-training&lt;/strong&gt;. The data set has a limited number of images (N = 3,662). We pre-train the CNN model on a larger data set from the previous Kaggle competition.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Fine-tuning&lt;/strong&gt;. We fine-tune the model on the target data set. We use cross-validation and make modeling decisions based on the performance of the out-of-fold predictions.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Inference&lt;/strong&gt;. We aggregate predictions of the models trained on different combinations of training folds and use test-time augmentation to further improve the performance.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Pre-training&quot;&gt;Pre-training&lt;a class=&quot;anchor-link&quot; href=&quot;#Pre-training&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Due to small sample size, we can not train a complex neural architecture from scratch. This is where transfer learning comes in handy. The idea of transfer learning is to pre-train a model on a different data (source domain) and fine-tune it on a relevant data set (target domain).&lt;/p&gt;
&lt;p&gt;A good candidate for the source domain is the &lt;a href=&quot;http://www.image-net.org&quot;&gt;ImageNet database&lt;/a&gt;. Most published CNN models are trained on that data. However, ImageNet images are substantially different from the retina images we want to classify. Although initializing CNN with ImageNet weights might help the network to transfer the knowledge of basic image patterns such as shapes and edges, we still need to learn a lot from the target domain.&lt;/p&gt;
&lt;p&gt;It turns out that APTOS had hosted another Kaggle competition on the DR classification in 2015. The data set of the 2015 competition features 35,126 retina images labeled by a clinician using the same scale as the target data set. The data is available for the download &lt;a href=&quot;https://www.kaggle.com/c/diabetic-retinopathy-detection/data&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This enables us to use following pipeline:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;initialize weights from a CNN trained on ImageNet&lt;/li&gt;
&lt;li&gt;train the CNN on the 2015 data set&lt;/li&gt;
&lt;li&gt;fine-tune the CNN on the 2019 data set&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's start modeling! First, we enable GPU support and fix random seeds. The function &lt;code&gt;seed_everything()&lt;/code&gt; sets seed for multiple packages, including &lt;code&gt;numpy&lt;/code&gt; and &lt;code&gt;pytorch&lt;/code&gt;, to ensure reproducibility.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# GPU check&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_on_gpu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_on_gpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;CUDA is not available. Training on CPU...&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;CUDA is available. Training on GPU...&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cuda:0&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# seed function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;seed_everything&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;environ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PYTHONHASHSEED&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manual_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manual_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backends&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudnn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deterministic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backends&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudnn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;benchmark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# set seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;seed_everything&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;CUDA is available. Training on GPU...
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's take a quick look at the class distribution in the 2015 data.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# import data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/diabetic-retinopathy-resized/trainLabels.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;id_code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/aptos2019-blindness-detection/train.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# check shape&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value_counts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normalize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value_counts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normalize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(35126, 2) (3662, 2)
---------------
0    0.734783
2    0.150658
1    0.069550
3    0.024853
4    0.020156
Name: diagnosis, dtype: float64
---------------
0    0.492900
2    0.272802
1    0.101038
4    0.080557
3    0.052703
Name: diagnosis, dtype: float64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The imbalance in the source data is stronger than in the target data: 73% of images represent healthy patients, whereas the most severe stage of the DR is only found in 2% of the images. To address the imbalance, we will use the target data set as a validation sample during training.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We create two &lt;code&gt;Dataset&lt;/code&gt; objects to enable different augmentations on training and inference stages: &lt;code&gt;EyeTrainData&lt;/code&gt; and &lt;code&gt;EyeTestData&lt;/code&gt;. The former includes a random crop that is skipped for the test data.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
  
&lt;span class=&quot;c1&quot;&gt;# dataset class: train&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;EyeTrainData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# initialize&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# length&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# get items    &lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__getitem__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;img_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;id_code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;.jpeg&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prepare_image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_random_crop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    
&lt;span class=&quot;c1&quot;&gt;# dataset class: test&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;EyeTestData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# initialize&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# length&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# get items    &lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__getitem__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;img_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;id_code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;.png&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prepare_image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_random_crop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We use a batch size of 20 and set the image size of 256. The choice of these parameters is a trade-off between performance and resource capacity. Feel free to try larger image and batch sizes if you have resources.&lt;/p&gt;
&lt;p&gt;We use the following data augmentations during training:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;random horizontal flip&lt;/li&gt;
&lt;li&gt;random vertical flip&lt;/li&gt;
&lt;li&gt;random rotation in the range [-360 degrees, 360 degrees]&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# train transformations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_trans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToPILImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                  &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomRotation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;360&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;360&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
                                  &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomHorizontalFlip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                  &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomVerticalFlip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                  &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                                 &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# validation transformations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_trans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToPILImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                  &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                 &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# create datasets&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EyeTrainData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                             &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/diabetic-retinopathy-resized/resized_train/resized_train&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_trans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EyeTestData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                            &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/aptos2019-blindness-detection/train_images&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_trans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# create data loaders&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                           &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                           &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                           &lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                           &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                           &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                           &lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Next, let's instantiate the EfficentNet model. We use B4 architecture and initialize pre-trained ImageNet weights by downloading the model parameters in the &lt;code&gt;PyTorch&lt;/code&gt; format. The convolutional part of the network responsible for feature extraction outputs a tensor with &lt;code&gt;1792&lt;/code&gt; features. To adapt the CNN to our task, we replace the last fully-connected classification layer with a &lt;code&gt;(1792, 5)&lt;/code&gt; fully-connected layer.&lt;/p&gt;
&lt;p&gt;The CNN is instantiated with &lt;code&gt;init_model()&lt;/code&gt;. The argument &lt;code&gt;train&lt;/code&gt; ensures that we load ImageNet weights on the training stage and turn off gradient computation on the inference stage.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# model name&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;enet_b4&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# initialization function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;### training mode&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                 
        &lt;span class=&quot;c1&quot;&gt;# load pre-trained model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EfficientNet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_pretrained&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;efficientnet-b4&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      
        
    &lt;span class=&quot;c1&quot;&gt;### inference mode&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# load pre-trained model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EfficientNet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;efficientnet-b4&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_fc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_fc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# freeze  layers&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requires_grad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
            
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# check architecture&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Since we are dealing with a multiple classification problem, we use cross-entropy as a loss function. We use &lt;code&gt;nn.CrossEntropyLoss()&lt;/code&gt; which combines logsoftmax and negative log-likelihood loss and applies them to the output of the last network layer.&lt;/p&gt;
&lt;p&gt;The Kaggle competition uses &lt;a href=&quot;https://towardsdatascience.com/cohens-kappa-9786ceceab58&quot;&gt;Cohen's kappa&lt;/a&gt; for evaluation. Kappa measures the agreement between the actual and predicted labels. Since Kappa is non-differentiable, we can not use it as a loss function. At the same time, we can use Kappa to evaluate the performance and early stop the training epochs.&lt;/p&gt;
&lt;p&gt;We use &lt;code&gt;Adam&lt;/code&gt; optimizer with a starting learning rate of 0.001. During training, we use a learning rate scheduler, which multiplies the learning rate by 0.5 after every 5 epochs. This helps to make smaller changes to the network weights when we are getting closer to the optimum.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# loss function&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CrossEntropyLoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# epochs&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;early_stop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# learning rates&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;eta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-3&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# scheduler&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# optimizer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr_scheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StepLR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# initialize model and send to GPU&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;After each training epoch, we validate the model on the target data. We extract class scores from the last fully-connected layer and predict the image class corresponding to the highest score. We train the network for 15 epochs, tracking the validation loss and Cohen's kappa. If the kappa does not increase for 5 consecutive epochs, we terminate the training process and save model weights for the epoch associated with the highest validation kappa.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# placeholders&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;oof_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;trn_losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# timer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cv_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# training and validation loop&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;##### PREPARATION&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# timer&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;epoch_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# reset losses&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;trn_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# placeholders&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;


    &lt;span class=&quot;c1&quot;&gt;##### TRAINING&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# switch regime&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# loop through batches&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# extract inputs and labels&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# forward and backward pass&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_grad_enabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# compute loss&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;trn_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        
    &lt;span class=&quot;c1&quot;&gt;##### INFERENCE&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# switch regime&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# loop through batches&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# extract inputs and labels&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# compute predictions&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_grad_enabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# compute loss&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# save predictions&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;oof_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# scheduler step&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;


    &lt;span class=&quot;c1&quot;&gt;##### EVALUATION&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# evaluate performance&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold_preds_round&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;val_kappa&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cohen_kappa_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold_preds_round&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;int&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;quadratic&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# save perfoirmance values&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_kappa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;trn_losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trn_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;


    &lt;span class=&quot;c1&quot;&gt;##### EARLY STOPPING&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# display info&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;- epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; | lr = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; | trn_loss = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; | val_loss = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; | val_kappa = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; | &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; min&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;trn_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_kappa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# check if there is any improvement&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;       
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# save model weights if improvement&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;oof_preds_best&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oof_preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../models/model_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.bin&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# break if early stop&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;early_stop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Early stopping. Best results: loss = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;, kappa = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; (epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# break if max epochs&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Did not met early stopping. Best results: loss = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;, kappa = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; (epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

        
&lt;span class=&quot;c1&quot;&gt;# load best predictions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;oof_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oof_preds_best&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# print performance&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Finished in &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; minutes&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Loaded pretrained weights for efficientnet-b4
- epoch 1/15 | lr = 0.001 | trn_loss = 0.7140 | val_loss = 1.3364 | val_kappa = 0.7268 | 30.03 min
- epoch 2/15 | lr = 0.001 | trn_loss = 0.6447 | val_loss = 1.0670 | val_kappa = 0.8442 | 27.19 min
- epoch 3/15 | lr = 0.001 | trn_loss = 0.6203 | val_loss = 0.7667 | val_kappa = 0.7992 | 27.21 min
- epoch 4/15 | lr = 0.001 | trn_loss = 0.6020 | val_loss = 0.7472 | val_kappa = 0.8245 | 27.68 min
- epoch 5/15 | lr = 0.00025 | trn_loss = 0.5899 | val_loss = 0.7720 | val_kappa = 0.8541 | 29.42 min
- epoch 6/15 | lr = 0.0005 | trn_loss = 0.5542 | val_loss = 0.9255 | val_kappa = 0.8682 | 29.33 min
- epoch 7/15 | lr = 0.0005 | trn_loss = 0.5424 | val_loss = 0.8917 | val_kappa = 0.8763 | 29.91 min
- epoch 8/15 | lr = 0.0005 | trn_loss = 0.5359 | val_loss = 0.9555 | val_kappa = 0.8661 | 30.70 min
- epoch 9/15 | lr = 0.0005 | trn_loss = 0.5252 | val_loss = 0.8642 | val_kappa = 0.8778 | 28.76 min
- epoch 10/15 | lr = 0.000125 | trn_loss = 0.5184 | val_loss = 1.1568 | val_kappa = 0.8403 | 31.14 min
- epoch 11/15 | lr = 0.00025 | trn_loss = 0.4974 | val_loss = 0.9464 | val_kappa = 0.8784 | 28.00 min
- epoch 12/15 | lr = 0.00025 | trn_loss = 0.4874 | val_loss = 0.9043 | val_kappa = 0.8820 | 27.50 min
- epoch 13/15 | lr = 0.00025 | trn_loss = 0.4820 | val_loss = 0.7924 | val_kappa = 0.8775 | 27.36 min
- epoch 14/15 | lr = 0.00025 | trn_loss = 0.4758 | val_loss = 0.9300 | val_kappa = 0.8761 | 27.33 min
- epoch 15/15 | lr = 6.25e-05 | trn_loss = 0.4693 | val_loss = 0.9109 | val_kappa = 0.8803 | 27.51 min
Did not met early stopping. Best results: loss = 0.7472, kappa = 0.8245 (epoch 4)


Finished in 429.16 minutes
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Training on the Kaggle GPU-enabled machine took us about 7 hours! Let's visualize the training and validation loss dynamics.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plot size&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plot loss dynamics&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trn_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Training&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;green&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Validation&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Epoch&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plot kappa dynamics&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Kappa&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Epoch&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Kappa&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_loss_pre_training.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The cross-entropy loss on the validation set reaches minimum already after 3 epochs. At the same time, kappa continues to increase up to the 15th epoch. Since we use kappa to evaluate the quality of our solution, we save weights after 15 epochs.&lt;/p&gt;
&lt;p&gt;We also construct a confusion matrix of the trained model. The numbers in the cells are percentages. According to the results, the model does a poor job in distinguishing the mild and moderate stages of DR: 86% of images with mild DR are classified as moderate. The best performance is observed for healthy patients. Overall, we see that the model tends to confuse nearby severity stages but rarely misclassifies the proliferate and mild stages.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_cm_pre_training.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Fine-tuning&quot;&gt;Fine-tuning&lt;a class=&quot;anchor-link&quot; href=&quot;#Fine-tuning&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Fine-tuning on the target data is performed within 4-fold cross-validation. To ensure that we have enough examples of each class, we perform cross-validation with stratification.&lt;/p&gt;
&lt;p&gt;On each iteration, we instantiate the EfficientNet B4 model with the same architecture as in the previous section. Next, we load the saved weights from the model pre-trained on the source data. We freeze weights on all network layers except for the last fully-connected layer. The weights in this layer are fine-tuned. As on the pre-training stage, we use &lt;code&gt;Adam&lt;/code&gt; optimizer and implement a learning rate scheduler. We also track performance on the validation folds and stop training if kappa does not increase for 5 consecutive epochs.&lt;/p&gt;
&lt;p&gt;The process is repeated for each of the 4 folds, and the best model weights are saved for each combination of the training folds.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The &lt;code&gt;init_model()&lt;/code&gt; is updated to load the weights saved on the pre-training stage and freeze the first layers of the network in the training regime.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# model name&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;enet_b4&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# initialization function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trn_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;### training mode&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                 
        &lt;span class=&quot;c1&quot;&gt;# load pre-trained model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EfficientNet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_pretrained&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;efficientnet-b4&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../models/model_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.bin&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;   
        
        &lt;span class=&quot;c1&quot;&gt;# freeze first layers&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;children&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trn_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;child&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requires_grad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
        
        
    &lt;span class=&quot;c1&quot;&gt;### inference mode&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# load pre-trained model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EfficientNet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_pretrained&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;efficientnet-b4&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../models/model_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.bin&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;   

        &lt;span class=&quot;c1&quot;&gt;# freeze all layers&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requires_grad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
            
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# check architecture&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The training loop is now wrapped into a cross-validation loop.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;##### VALIDATION SETTINGS&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# no. folds&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# creating splits&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;skf&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StratifiedKFold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_splits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;splits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;id_code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# placeholders&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;oof_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# timer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cv_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;##### PARAMETERS&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# loss function&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CrossEntropyLoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# epochs&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;early_stop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# learning rates&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;eta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-3&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# scheduler&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;##### CROSS-VALIDATION LOOP&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;####### DATA PREPARATION&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# display information&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;FOLD &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# load splits&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;data_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;data_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# create datasets&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EyeTrainData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                 &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/aptos2019-blindness-detection/train_images&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_trans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EyeTrainData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                 &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/aptos2019-blindness-detection/train_images&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_trans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# create data loaders&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                               &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                               &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                               &lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;valid_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                               &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                               &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                               &lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    
    &lt;span class=&quot;c1&quot;&gt;####### MODEL PREPARATION&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# placeholders&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;trn_losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# load best OOF predictions&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;oof_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oof_preds_best&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# initialize and send to GPU&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# optimizer&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_fc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr_scheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StepLR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    
    &lt;span class=&quot;c1&quot;&gt;####### TRAINING AND VALIDATION LOOP&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;##### PREPARATION&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# timer&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;epoch_start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# reset losses&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;trn_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# placeholders&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;


        &lt;span class=&quot;c1&quot;&gt;##### TRAINING&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# switch regime&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# loop through batches&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# extract inputs and labels&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# forward and backward pass&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_grad_enabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# compute loss&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;trn_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


        &lt;span class=&quot;c1&quot;&gt;##### INFERENCE&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# initialize&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# loop through batches&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# extract inputs and labels&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# compute predictions&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_grad_enabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;topk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# compute loss&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# save predictions&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;oof_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# scheduler step&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;


        &lt;span class=&quot;c1&quot;&gt;##### EVALUATION&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# evaluate performance&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fold_preds_round&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_kappa&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cohen_kappa_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold_preds_round&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;int&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;quadratic&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# save perfoirmance values&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_kappa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;trn_losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trn_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

        
        &lt;span class=&quot;c1&quot;&gt;##### EARLY STOPPING&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# display info&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;- epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; | lr = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; | trn_loss = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; | val_loss = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; | val_kappa = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; | &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; min&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;trn_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_kappa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# check if there is any improvement&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;       
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# save model weights if improvement&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;oof_preds_best&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oof_preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../models/model_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;_fold&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.bin&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# break if early stop&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bad_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;early_stop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Early stopping. Best results: loss = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;, kappa = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; (epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# break if max epochs&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Did not meet early stopping. Best results: loss = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;, kappa = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; (epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_kappas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
        

&lt;span class=&quot;c1&quot;&gt;# load best predictions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;oof_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oof_preds_best&lt;/span&gt;
            
&lt;span class=&quot;c1&quot;&gt;# print performance&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Finished in &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; minutes&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;------------------------------
FOLD 1/4
------------------------------
Loaded pretrained weights for efficientnet-b4
- epoch 1/15 | lr = 0.001 | trn_loss = 0.6279 | val_loss = 0.5368 | val_kappa = 0.8725 | 7.30 min
- epoch 2/15 | lr = 0.001 | trn_loss = 0.5699 | val_loss = 0.5402 | val_kappa = 0.8662 | 7.25 min
- epoch 3/15 | lr = 0.001 | trn_loss = 0.5572 | val_loss = 0.5380 | val_kappa = 0.8631 | 7.31 min
- epoch 4/15 | lr = 0.001 | trn_loss = 0.5482 | val_loss = 0.5357 | val_kappa = 0.8590 | 7.29 min
- epoch 5/15 | lr = 0.00025 | trn_loss = 0.5658 | val_loss = 0.5357 | val_kappa = 0.8613 | 7.25 min
- epoch 6/15 | lr = 0.0005 | trn_loss = 0.5537 | val_loss = 0.5346 | val_kappa = 0.8604 | 7.28 min
Early stopping. Best results: loss = 0.5346, kappa = 0.8604 (epoch 6)

------------------------------
FOLD 2/4
------------------------------
Loaded pretrained weights for efficientnet-b4
- epoch 1/15 | lr = 0.001 | trn_loss = 0.6535 | val_loss = 0.5295 | val_kappa = 0.8767 | 7.24 min
- epoch 2/15 | lr = 0.001 | trn_loss = 0.5691 | val_loss = 0.5158 | val_kappa = 0.8717 | 7.20 min
- epoch 3/15 | lr = 0.001 | trn_loss = 0.5645 | val_loss = 0.5136 | val_kappa = 0.8732 | 7.23 min
- epoch 4/15 | lr = 0.001 | trn_loss = 0.5592 | val_loss = 0.5151 | val_kappa = 0.8705 | 7.26 min
- epoch 5/15 | lr = 0.00025 | trn_loss = 0.5530 | val_loss = 0.5213 | val_kappa = 0.8686 | 7.27 min
- epoch 6/15 | lr = 0.0005 | trn_loss = 0.5499 | val_loss = 0.5143 | val_kappa = 0.8733 | 7.21 min
Early stopping. Best results: loss = 0.5136, kappa = 0.8732 (epoch 3)

------------------------------
FOLD 3/4
------------------------------
Loaded pretrained weights for efficientnet-b4
- epoch 1/15 | lr = 0.001 | trn_loss = 0.6503 | val_loss = 0.5286 | val_kappa = 0.8937 | 7.16 min
- epoch 2/15 | lr = 0.001 | trn_loss = 0.5916 | val_loss = 0.5166 | val_kappa = 0.8895 | 7.20 min
- epoch 3/15 | lr = 0.001 | trn_loss = 0.5702 | val_loss = 0.5115 | val_kappa = 0.8834 | 7.34 min
- epoch 4/15 | lr = 0.001 | trn_loss = 0.5606 | val_loss = 0.5133 | val_kappa = 0.8829 | 7.44 min
- epoch 5/15 | lr = 0.00025 | trn_loss = 0.5640 | val_loss = 0.5081 | val_kappa = 0.8880 | 7.28 min
- epoch 6/15 | lr = 0.0005 | trn_loss = 0.5515 | val_loss = 0.5109 | val_kappa = 0.8871 | 7.20 min
Early stopping. Best results: loss = 0.5081, kappa = 0.8880 (epoch 5)

------------------------------
FOLD 4/4
------------------------------
Loaded pretrained weights for efficientnet-b4
- epoch 1/15 | lr = 0.001 | trn_loss = 0.6379 | val_loss = 0.5563 | val_kappa = 0.8595 | 7.18 min
- epoch 2/15 | lr = 0.001 | trn_loss = 0.5718 | val_loss = 0.5423 | val_kappa = 0.8610 | 7.20 min
- epoch 3/15 | lr = 0.001 | trn_loss = 0.5590 | val_loss = 0.5433 | val_kappa = 0.8587 | 7.19 min
- epoch 4/15 | lr = 0.001 | trn_loss = 0.5554 | val_loss = 0.5433 | val_kappa = 0.8579 | 7.17 min
- epoch 5/15 | lr = 0.00025 | trn_loss = 0.5476 | val_loss = 0.5393 | val_kappa = 0.8608 | 7.18 min
- epoch 6/15 | lr = 0.0005 | trn_loss = 0.5509 | val_loss = 0.5331 | val_kappa = 0.8610 | 7.32 min
- epoch 7/15 | lr = 0.0005 | trn_loss = 0.5532 | val_loss = 0.5309 | val_kappa = 0.8567 | 7.28 min
Early stopping. Best results: loss = 0.5309, kappa = 0.8567 (epoch 7)



Finished in 181.29 minutes
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The model converges rather quickly. The best validation performance is obtained after 3 to 7 training epochs depending on a fold.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's look at the confusion matrix. The matrix illustrates the advantages of the fine-tuned model over the pre-trained CNN and indicates a better performance in classifying mild stages of the DR. However, we also observe that the model classifies too many examples as moderate (class = 2).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# construct confusion matrx&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;oof_preds_round&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oof_preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;diagnosis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oof_preds_round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;annot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;around&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plot matrix&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;heatmap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Blues&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;annot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;annot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Prediction&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Ground Truth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_aspect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;equal&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/fig_cm_fine_tuning.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Inference&quot;&gt;Inference&lt;a class=&quot;anchor-link&quot; href=&quot;#Inference&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's now produce some predictions for the test set!&lt;/p&gt;
&lt;p&gt;We aggregate predictions from the models trained during the cross-validation loop. To do so, we extract class scores from the last fully-connected layer and define class predictions as the classes with the maximal score. Next, we average predictions of the 4 networks trained on different combinations of the training folds.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;############ TRANSFORMATIONS&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;image_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# test transformations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_trans&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToPILImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                  &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomHorizontalFlip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                  &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RandomVerticalFlip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
                                  &lt;span class=&quot;n&quot;&gt;transforms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
                                 &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;############ DATA LOADER&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# create dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EyeTestData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                           &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../input/aptos2019-blindness-detection/test_images&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_trans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# create data loader&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_loader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                          &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                          &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                          &lt;span class=&quot;n&quot;&gt;num_workers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;############ MODEL ARCHITECTURE&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# model name&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;enet_b4&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# initialization function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trn_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;### training mode&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                 
        &lt;span class=&quot;c1&quot;&gt;# load pre-trained model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EfficientNet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_pretrained&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;efficientnet-b4&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# freeze first layers&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;children&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trn_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;child&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requires_grad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
        
        
    &lt;span class=&quot;c1&quot;&gt;### inference mode&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# load pre-trained model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EfficientNet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;efficientnet-b4&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_fc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_fc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# freeze all layers&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requires_grad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
            
            
    &lt;span class=&quot;c1&quot;&gt;### return model&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# check architecture&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We also use test-time augmentations by creating 4 versions of the test images with random augmentations (horizontal and vertical flips) and average predictions over the image variants. The final prediction is an average of 4 models times 4 image variants.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# validation settings&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tta_times&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# placeholders&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cv_start&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# prediction loop&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# load model and sent to GPU&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;../models/model_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;_fold&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.bin&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# placeholder&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# loop through batches&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tta_times&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_loader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;image&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;topk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tta_times&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# aggregate predictions&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;test_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fold_preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# print performance&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_preds_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Finished in &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.2f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; minutes&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's have a look at the distribution of predictions:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# show predictions&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PREDICTIONS&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_preds_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# show correlation&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;CORRELATION MATRIX&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_preds_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Mean correlation = &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_preds_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# show stats&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;SUMMARY STATS&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_preds_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# show prediction distribution&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ROUNDED PREDICTIONS&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_preds_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;int&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value_counts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normalize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plot densities&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_preds_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kde&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;---------------------------------------------
PREDICTIONS
---------------------------------------------
     0    1    2    3
0  2.0  2.0  2.0  1.5
1  2.0  2.5  2.0  2.0
2  2.0  2.0  2.0  2.0
3  2.0  3.0  2.0  2.0
4  2.0  2.0  2.0  2.0
---------------------------------------------
CORRELATION MATRIX
---------------------------------------------
        0       1       2       3
0  1.0000  0.9624  0.9573  0.9534
1  0.9624  1.0000  0.9686  0.9490
2  0.9573  0.9686  1.0000  0.9478
3  0.9534  0.9490  0.9478  1.0000
Mean correlation = 0.9673
---------------------------------------------
SUMMARY STATS
---------------------------------------------
                 0            1            2            3
count  1928.000000  1928.000000  1928.000000  1928.000000
mean      1.686722     1.710322     1.715249     1.650156
std       0.972716     0.973031     0.970417     0.960637
min       0.000000     0.000000     0.000000     0.000000
25%       1.500000     2.000000     2.000000     1.375000
50%       2.000000     2.000000     2.000000     2.000000
75%       2.000000     2.000000     2.000000     2.000000
max       4.000000     4.000000     4.000000     4.000000
---------------------------------------------
ROUNDED PREDICTIONS
---------------------------------------------
2    0.665456
0    0.200207
1    0.047199
3    0.044087
4    0.043050
Name: 0, dtype: float64
---------------------------------------------
2    0.670124
0    0.195021
4    0.046162
3    0.045124
1    0.043568
Name: 1, dtype: float64
---------------------------------------------
2    0.678942
0    0.195021
4    0.048755
1    0.038900
3    0.038382
Name: 2, dtype: float64
---------------------------------------------
2    0.685685
0    0.207988
1    0.042012
4    0.040975
3    0.023340
Name: 3, dtype: float64
---------------------------------------------
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;lt;matplotlib.axes._subplots.AxesSubplot at 0x7f8e403032d0&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The model classifies a lot of images as moderate DR. To reduce the number of such examples, we can change thresholds used to round the averaged predictions into classes. We use the following vector of thresholds: [0.5, 1.75, 2.25, 3.5]. The final prediction is set to zero if the average value is below 0.5; set to one if the average value lies in [0.5, 1.75), etc. This reduces the share of images classified as moderate DR.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# aggregate predictions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_preds_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# set cutoffs&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;coef&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.75&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# rounding&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;test_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;test_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;test_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;test_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;test_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We are done! We can now export &lt;code&gt;test_preds&lt;/code&gt; as csv and submit it to the competition.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;5.-Closing-words&quot;&gt;5. Closing words&lt;a class=&quot;anchor-link&quot; href=&quot;#5.-Closing-words&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This blogpost provides a complete walkthrough on the project on detecting blindness in the retina images using CNNs. We use image preprocessing to reduce discrepancies across images taken in different clinics, apply transfer learning to leverage knowledge from larger data sets and implement different techniques to improve performance.&lt;/p&gt;
&lt;p&gt;If you are still reading this post, you might be wondering about ways to further improve the solution. There are multiple options. First, employing a larger network architecture and increasing the number of training epochs on the pre-training stage has a high potential for a better performance. At the same time, this would require more computing power, which might not be optimal considering the possible use of the automated retina image classification in practice.&lt;/p&gt;
&lt;p&gt;Second, image preprocessing can be further improved. During the refinement process, the largest performance gains were attributed to different preprocessing steps. This is a more efficient way to further improve the performance.&lt;/p&gt;
&lt;p&gt;Finally, the best solutions of other competitors rely on ensembles of CNNs using different image sizes and/or architectures. Incorporating multiple heterogeneous models and blending their predictions could also improve the proposed solution. Ensembling predictions of models similar to the one discussed in this post is what helped me to place in the top 9% of the leaderboard.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;script type=&quot;application/vnd.jupyter.widget-state+json&quot;&gt;
{&quot;state&quot;: {&quot;0e541176c8f04bb79cf4bb3c1e525ef1&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_module_version&quot;: &quot;1.2.0&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;_view_count&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;align_content&quot;: null, &quot;align_items&quot;: null, &quot;align_self&quot;: null, &quot;border&quot;: null, &quot;bottom&quot;: null, &quot;display&quot;: null, &quot;flex&quot;: null, &quot;flex_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_column&quot;: null, &quot;grid_gap&quot;: null, &quot;grid_row&quot;: null, &quot;grid_template_areas&quot;: null, &quot;grid_template_columns&quot;: null, &quot;grid_template_rows&quot;: null, &quot;height&quot;: null, &quot;justify_content&quot;: null, &quot;justify_items&quot;: null, &quot;left&quot;: null, &quot;margin&quot;: null, &quot;max_height&quot;: null, &quot;max_width&quot;: null, &quot;min_height&quot;: null, &quot;min_width&quot;: null, &quot;object_fit&quot;: null, &quot;object_position&quot;: null, &quot;order&quot;: null, &quot;overflow&quot;: null, &quot;overflow_x&quot;: null, &quot;overflow_y&quot;: null, &quot;padding&quot;: null, &quot;right&quot;: null, &quot;top&quot;: null, &quot;visibility&quot;: null, &quot;width&quot;: null}}, &quot;159b8413aa00480e8ad91a46046fc7e9&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_module_version&quot;: &quot;1.5.0&quot;, &quot;model_name&quot;: &quot;HTMLModel&quot;, &quot;state&quot;: {&quot;_dom_classes&quot;: [], &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_model_name&quot;: &quot;HTMLModel&quot;, &quot;_view_count&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_name&quot;: &quot;HTMLView&quot;, &quot;description&quot;: &quot;&quot;, &quot;description_tooltip&quot;: null, &quot;layout&quot;: &quot;IPY_MODEL_464c364c93434011a46a1d8bd6365904&quot;, &quot;placeholder&quot;: &quot;\u200b&quot;, &quot;style&quot;: &quot;IPY_MODEL_8ec5d9c4da304abf87e0e6239e0eda63&quot;, &quot;value&quot;: &quot; 3662/3662 [04:56&amp;lt;00:00, 12.34it/s]&quot;}}, &quot;2016cb60541a4d00b926ce23a107d8e2&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_module_version&quot;: &quot;1.5.0&quot;, &quot;model_name&quot;: &quot;FloatProgressModel&quot;, &quot;state&quot;: {&quot;_dom_classes&quot;: [], &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_model_name&quot;: &quot;FloatProgressModel&quot;, &quot;_view_count&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_name&quot;: &quot;ProgressView&quot;, &quot;bar_style&quot;: &quot;success&quot;, &quot;description&quot;: &quot;100%&quot;, &quot;description_tooltip&quot;: null, &quot;layout&quot;: &quot;IPY_MODEL_0e541176c8f04bb79cf4bb3c1e525ef1&quot;, &quot;max&quot;: 3662, &quot;min&quot;: 0, &quot;orientation&quot;: &quot;horizontal&quot;, &quot;style&quot;: &quot;IPY_MODEL_35edb5bfea814611b721e486a3807142&quot;, &quot;value&quot;: 3662}}, &quot;30637eb546ab41848cf1ba6347d5ff1c&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_module_version&quot;: &quot;1.5.0&quot;, &quot;model_name&quot;: &quot;HBoxModel&quot;, &quot;state&quot;: {&quot;_dom_classes&quot;: [], &quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_model_name&quot;: &quot;HBoxModel&quot;, &quot;_view_count&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_view_module_version&quot;: &quot;1.5.0&quot;, &quot;_view_name&quot;: &quot;HBoxView&quot;, &quot;box_style&quot;: &quot;&quot;, &quot;children&quot;: [&quot;IPY_MODEL_2016cb60541a4d00b926ce23a107d8e2&quot;, &quot;IPY_MODEL_159b8413aa00480e8ad91a46046fc7e9&quot;], &quot;layout&quot;: &quot;IPY_MODEL_78fca7c58b344d1ebd93c6afb3e4927d&quot;}}, &quot;35edb5bfea814611b721e486a3807142&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_module_version&quot;: &quot;1.5.0&quot;, &quot;model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;state&quot;: {&quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_model_name&quot;: &quot;ProgressStyleModel&quot;, &quot;_view_count&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_name&quot;: &quot;StyleView&quot;, &quot;bar_color&quot;: null, &quot;description_width&quot;: &quot;initial&quot;}}, &quot;464c364c93434011a46a1d8bd6365904&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_module_version&quot;: &quot;1.2.0&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;_view_count&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;align_content&quot;: null, &quot;align_items&quot;: null, &quot;align_self&quot;: null, &quot;border&quot;: null, &quot;bottom&quot;: null, &quot;display&quot;: null, &quot;flex&quot;: null, &quot;flex_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_column&quot;: null, &quot;grid_gap&quot;: null, &quot;grid_row&quot;: null, &quot;grid_template_areas&quot;: null, &quot;grid_template_columns&quot;: null, &quot;grid_template_rows&quot;: null, &quot;height&quot;: null, &quot;justify_content&quot;: null, &quot;justify_items&quot;: null, &quot;left&quot;: null, &quot;margin&quot;: null, &quot;max_height&quot;: null, &quot;max_width&quot;: null, &quot;min_height&quot;: null, &quot;min_width&quot;: null, &quot;object_fit&quot;: null, &quot;object_position&quot;: null, &quot;order&quot;: null, &quot;overflow&quot;: null, &quot;overflow_x&quot;: null, &quot;overflow_y&quot;: null, &quot;padding&quot;: null, &quot;right&quot;: null, &quot;top&quot;: null, &quot;visibility&quot;: null, &quot;width&quot;: null}}, &quot;78fca7c58b344d1ebd93c6afb3e4927d&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;model_module_version&quot;: &quot;1.2.0&quot;, &quot;model_name&quot;: &quot;LayoutModel&quot;, &quot;state&quot;: {&quot;_model_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_model_module_version&quot;: &quot;1.2.0&quot;, &quot;_model_name&quot;: &quot;LayoutModel&quot;, &quot;_view_count&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_name&quot;: &quot;LayoutView&quot;, &quot;align_content&quot;: null, &quot;align_items&quot;: null, &quot;align_self&quot;: null, &quot;border&quot;: null, &quot;bottom&quot;: null, &quot;display&quot;: null, &quot;flex&quot;: null, &quot;flex_flow&quot;: null, &quot;grid_area&quot;: null, &quot;grid_auto_columns&quot;: null, &quot;grid_auto_flow&quot;: null, &quot;grid_auto_rows&quot;: null, &quot;grid_column&quot;: null, &quot;grid_gap&quot;: null, &quot;grid_row&quot;: null, &quot;grid_template_areas&quot;: null, &quot;grid_template_columns&quot;: null, &quot;grid_template_rows&quot;: null, &quot;height&quot;: null, &quot;justify_content&quot;: null, &quot;justify_items&quot;: null, &quot;left&quot;: null, &quot;margin&quot;: null, &quot;max_height&quot;: null, &quot;max_width&quot;: null, &quot;min_height&quot;: null, &quot;min_width&quot;: null, &quot;object_fit&quot;: null, &quot;object_position&quot;: null, &quot;order&quot;: null, &quot;overflow&quot;: null, &quot;overflow_x&quot;: null, &quot;overflow_y&quot;: null, &quot;padding&quot;: null, &quot;right&quot;: null, &quot;top&quot;: null, &quot;visibility&quot;: null, &quot;width&quot;: null}}, &quot;8ec5d9c4da304abf87e0e6239e0eda63&quot;: {&quot;model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;model_module_version&quot;: &quot;1.5.0&quot;, &quot;model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;state&quot;: {&quot;_model_module&quot;: &quot;@jupyter-widgets/controls&quot;, &quot;_model_module_version&quot;: &quot;1.5.0&quot;, &quot;_model_name&quot;: &quot;DescriptionStyleModel&quot;, &quot;_view_count&quot;: null, &quot;_view_module&quot;: &quot;@jupyter-widgets/base&quot;, &quot;_view_module_version&quot;: &quot;1.2.0&quot;, &quot;_view_name&quot;: &quot;StyleView&quot;, &quot;description_width&quot;: &quot;&quot;}}}, &quot;version_major&quot;: 2, &quot;version_minor&quot;: 0}
&lt;/script&gt;</content><author><name>Nikita Kozodoi</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://kozodoi.me/images/posts/retina.png" /><media:content medium="image" url="https://kozodoi.me/images/posts/retina.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Algorithmic Fairness in R</title><link href="https://kozodoi.me/r/fairness/packages/2020/05/01/fairness-tutorial.html" rel="alternate" type="text/html" title="Algorithmic Fairness in R" /><published>2020-05-01T00:00:00-05:00</published><updated>2020-05-01T00:00:00-05:00</updated><id>https://kozodoi.me/r/fairness/packages/2020/05/01/fairness-tutorial</id><content type="html" xml:base="https://kozodoi.me/r/fairness/packages/2020/05/01/fairness-tutorial.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-01-fairness-tutorial.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;1.-Overview&quot;&gt;1. Overview&lt;a class=&quot;anchor-link&quot; href=&quot;#1.-Overview&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;How to measure fairness of a machine learning model?&lt;/p&gt;
&lt;p&gt;To date, a number of algorithmic fairness metrics have been proposed. Demographic parity, proportional parity, equalized odds and predictive rate parity are the most commonly used metrics to evaluate fairness between sensitive groups in binary classification problems. Multiple other metrics have been proposed that use various performance measures extracted from the confusion matrix (e.g., false positive rate parity, false negative rate parity).&lt;/p&gt;
&lt;p&gt;Together with &lt;a href=&quot;https://www.linkedin.com/in/tiborvvarga/&quot;&gt;Tibor V. Varga&lt;/a&gt;, we developed the &lt;code&gt;fairness&lt;/code&gt; R package. The package provides tools to calculate algorithmic fairness metrics for predictions of a classification model across different sensitive groups. It also provides opportunities to visualize and compare other prediction metrics between the subgroups.&lt;/p&gt;
&lt;p&gt;The package contains functions to compute the commonly used group fairness metrics such as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Demographic parity&lt;/li&gt;
&lt;li&gt;Proportional parity&lt;/li&gt;
&lt;li&gt;Equalized odds&lt;/li&gt;
&lt;li&gt;Predictive rate parity&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In addition, the following comparisons are also implemented:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;False positive rate parity&lt;/li&gt;
&lt;li&gt;False negative rate parity&lt;/li&gt;
&lt;li&gt;Accuracy parity&lt;/li&gt;
&lt;li&gt;Negative predictive value parity&lt;/li&gt;
&lt;li&gt;Specificity parity&lt;/li&gt;
&lt;li&gt;ROC AUC comparison&lt;/li&gt;
&lt;li&gt;MCC comparison&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This blogpost provides a tutorial on computing and visualizing different fariness metrics using the &lt;code&gt;fairness&lt;/code&gt; package. The package is published on &lt;a href=&quot;https://cran.r-project.org/package=fairness&quot;&gt;CRAN&lt;/a&gt; and &lt;a href=&quot;https://github.com/kozodoi/fairness&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Disclaimer! None of the implemented metrics are supposed to replace critical thinking about the problem in question.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;2.-Installation&quot;&gt;2. Installation&lt;a class=&quot;anchor-link&quot; href=&quot;#2.-Installation&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;You can install the latest stable package version from CRAN by running:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;fairness&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fairness&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Installing package into ‘/usr/local/lib/R/site-library’
(as ‘lib’ is unspecified)

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;You may also install the development version from Github:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;devtools&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;install_github&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;kozodoi/fairness&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fairness&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;3.-Data-description&quot;&gt;3. Data description&lt;a class=&quot;anchor-link&quot; href=&quot;#3.-Data-description&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The package includes two exemplary data sets to study fairness: &lt;code&gt;compas&lt;/code&gt; and &lt;code&gt;germancredit&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;compas&quot;&gt;compas&lt;a class=&quot;anchor-link&quot; href=&quot;#compas&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this tutorial, you will be able to use a simplified version of the landmark COMPAS data set containing the criminal history of defendants from Broward County. You can read more about the data &lt;a href=&quot;https://github.com/propublica/compas-analysis&quot;&gt;here&lt;/a&gt;. To load the data set, all you need to do is:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;compas&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A data.frame: 6 × 9&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Two_yr_Recidivism&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Number_of_Priors&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Age_Above_FourtyFive&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Age_Below_TwentyFive&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Female&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Misdemeanor&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;ethnicity&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;probability&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;predicted&lt;/th&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;dbl&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;dbl&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;dbl&amp;gt;&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;4&lt;/th&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;-0.6843578&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;Male  &lt;/td&gt;&lt;td&gt;yes&lt;/td&gt;&lt;td&gt;Other           &lt;/td&gt;&lt;td&gt;0.3151557&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;5&lt;/th&gt;&lt;td&gt;yes&lt;/td&gt;&lt;td&gt; 2.2668817&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;Male  &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;Caucasian       &lt;/td&gt;&lt;td&gt;0.8854616&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;7&lt;/th&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;-0.6843578&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;Female&lt;/td&gt;&lt;td&gt;yes&lt;/td&gt;&lt;td&gt;Caucasian       &lt;/td&gt;&lt;td&gt;0.2552680&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;11&lt;/th&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;-0.6843578&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;Male  &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;African_American&lt;/td&gt;&lt;td&gt;0.4173908&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;14&lt;/th&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;-0.6843578&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;Male  &lt;/td&gt;&lt;td&gt;yes&lt;/td&gt;&lt;td&gt;Hispanic        &lt;/td&gt;&lt;td&gt;0.3200982&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;24&lt;/th&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;-0.6843578&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;no&lt;/td&gt;&lt;td&gt;Male  &lt;/td&gt;&lt;td&gt;yes&lt;/td&gt;&lt;td&gt;Other           &lt;/td&gt;&lt;td&gt;0.3151557&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The data set contains nine variables. The outcome variable is &lt;code&gt;Two_yr_Recidivism&lt;/code&gt;, which is a binary indicator showing whether an individual commited a crime within the two-year period. The data also includes features on prior criminal record (&lt;code&gt;Number_of_Priors&lt;/code&gt;, &lt;code&gt;Misdemeanor&lt;/code&gt;) and other features describing age (&lt;code&gt;Age_Above_FourtyFive&lt;/code&gt;, &lt;code&gt;Age_Below_TwentyFive&lt;/code&gt;), sex and ethnicity (&lt;code&gt;Female&lt;/code&gt;, &lt;code&gt;ethnicity&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;You don’t really need to delve into the data much. To simplify illustration, we have already trained a classifier that uses all available features to predict &lt;code&gt;Two_yr_Recidivism&lt;/code&gt; and concatenated the predicted probabilities (&lt;code&gt;probability&lt;/code&gt;) and predicted classes (&lt;code&gt;predicted&lt;/code&gt;) to the data frame. You will be able to use these columns with predictions directly in your analysis to test different metrics before using a real model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;germancredit&quot;&gt;germancredit&lt;a class=&quot;anchor-link&quot; href=&quot;#germancredit&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The second data set included in the package is a credit scoring data set labeled as &lt;code&gt;germancredit&lt;/code&gt;. The data set includes 20 features describing the loan applicants and an outcome variable named &lt;code&gt;BAD&lt;/code&gt;, which is a binary indicator showing whether the applicant defaulted on a loan. Similarly to the compas data set, this data also includes two columns with model predictions named &lt;code&gt;probability&lt;/code&gt; and &lt;code&gt;predicted&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Feel free to play with this data as well. You can load it with:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;germancredit&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;4.-Train-a-classifier&quot;&gt;4. Train a classifier&lt;a class=&quot;anchor-link&quot; href=&quot;#4.-Train-a-classifier&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;For the purpose of this tutorial, we will train two new models using different sets of features:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;model that uses all features as input&lt;/li&gt;
&lt;li&gt;model that uses all features except for ethnicity  &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We partition the COMPAS data into training and validation subsets and use logistic regression as base classifier.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# extract data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;compas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fairness&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!(&lt;/span&gt;colnames&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;compas&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; %in% c&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;probability&amp;#39;&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;&amp;#39;predicted&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# partitioning params&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;77&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_percent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_idx&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nrow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nrow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_percent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# partition the data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# check dim&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nrow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nrow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[1] 4320
[1] 1852
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# fit logit models&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;glm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Two_yr_Recidivism&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;            
              &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
              &lt;span class=&quot;n&quot;&gt;family&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;binomial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;link&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;logit&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;glm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Two_yr_Recidivism&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ethnicity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
              &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
              &lt;span class=&quot;n&quot;&gt;family&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;binomial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;link&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;logit&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's append model predictions to the validation set. Later, we will evaluate fairness of the two models based on these predictions.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# produce predictions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prob_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prob_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A data.frame: 6 × 9&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Two_yr_Recidivism&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Number_of_Priors&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Age_Above_FourtyFive&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Age_Below_TwentyFive&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Female&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Misdemeanor&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;ethnicity&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;prob_1&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;prob_2&lt;/th&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;dbl&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;fct&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;dbl&amp;gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;&amp;lt;dbl&amp;gt;&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;1185&lt;/th&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;-0.6843578&lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;Male  &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;African_American&lt;/td&gt;&lt;td&gt;0.3678771&lt;/td&gt;&lt;td&gt;0.3481577&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;5535&lt;/th&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt; 2.0560789&lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;Male  &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;Hispanic        &lt;/td&gt;&lt;td&gt;0.8024180&lt;/td&gt;&lt;td&gt;0.8347748&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;6054&lt;/th&gt;&lt;td&gt;yes&lt;/td&gt;&lt;td&gt;-0.4735549&lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;yes&lt;/td&gt;&lt;td&gt;Male  &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;African_American&lt;/td&gt;&lt;td&gt;0.5895862&lt;/td&gt;&lt;td&gt;0.5730560&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;2320&lt;/th&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;-0.6843578&lt;/td&gt;&lt;td&gt;yes&lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;Male  &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;African_American&lt;/td&gt;&lt;td&gt;0.2395689&lt;/td&gt;&lt;td&gt;0.2218929&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;3458&lt;/th&gt;&lt;td&gt;yes&lt;/td&gt;&lt;td&gt; 0.5804592&lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;Male  &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;Caucasian       &lt;/td&gt;&lt;td&gt;0.5915503&lt;/td&gt;&lt;td&gt;0.6010710&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;2114&lt;/th&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;-0.6843578&lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;no &lt;/td&gt;&lt;td&gt;Female&lt;/td&gt;&lt;td&gt;yes&lt;/td&gt;&lt;td&gt;Caucasian       &lt;/td&gt;&lt;td&gt;0.2480556&lt;/td&gt;&lt;td&gt;0.2496530&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;5.-Algorithmic-fairness-metrics&quot;&gt;5. Algorithmic fairness metrics&lt;a class=&quot;anchor-link&quot; href=&quot;#5.-Algorithmic-fairness-metrics&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The package currently includes nine fairness metrics and two other performance comparisons. Many of these metrics are mutually exclusive: results from a given classification problem most often cannot be fair in terms of all group fairness metrics. Depending on a context, it is important to select an appropriate metric to evaluate fairness.&lt;/p&gt;
&lt;p&gt;Below, we intrdocue functions that are used to compute the implemented metrics. Every function has a similar set of arguments:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;data&lt;/code&gt;: data.frame with the features and predictions&lt;/li&gt;
&lt;li&gt;&lt;code&gt;outcome&lt;/code&gt;: name of the outcome variable&lt;/li&gt;
&lt;li&gt;&lt;code&gt;group&lt;/code&gt;: name of the sensitive group, which needs to be a factor variable included in the data.frame.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;base&lt;/code&gt;: name of the base group (factor level of &lt;code&gt;group&lt;/code&gt;) that serves as a base for fairness metrics&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We also need to supply model predictions. Depending on a metric, we need to provide either porbabilistic predictions as &lt;code&gt;probs&lt;/code&gt; or class predictions as &lt;code&gt;preds&lt;/code&gt;. The model predictions can be appended to the original data.frame or provided as a vector. In this tutorial, we will use probabilistic predctions with all functions.&lt;/p&gt;
&lt;p&gt;When working with probabilistic predictions, some metrics also require a cutoff value to convert probabilities into class precictions supplied as &lt;code&gt;cutoff&lt;/code&gt;. Finally, we also need to specifiy factor levels to indicate the reference classes using the &lt;code&gt;preds_levels&lt;/code&gt; argument. The first level refers to the base class, whereas the second level indicates the predicted class for which probabilities are provided.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;An-outlook-on-the-confusion-matrix&quot;&gt;An outlook on the confusion matrix&lt;a class=&quot;anchor-link&quot; href=&quot;#An-outlook-on-the-confusion-matrix&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Most fairness metrics are calculated based on a confusion matrix produced by a classification model. The confusion matrix is comprised of four distinct classes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;True positives&lt;/strong&gt; (TP): the true class is positive and the prediction is positive (correct classification)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;False positives&lt;/strong&gt; (FP): the true class is negative and the prediction is positive (incorrect classification)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;True negatives&lt;/strong&gt; (TN): the true class is negative and the prediction is negative (correct classification)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;False negatives&lt;/strong&gt; (FN): the true class is positive and the prediction is negative (incorrect classification)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The fairness metrics are calculated by comparing one or more of these measures computed for different sensitive subgroups (e.g., male and female). For a detailed overview of various measures coming from the confusion matrix and precise definitions, please click &lt;a href=&quot;https://en.wikipedia.org/wiki/Confusion_matrix&quot;&gt;here&lt;/a&gt; or &lt;a href=&quot;https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Predictive-rate-parity&quot;&gt;Predictive rate parity&lt;a class=&quot;anchor-link&quot; href=&quot;#Predictive-rate-parity&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Let's demonstrate the fairness pipeline using predictive rate parity as an example. Predictive rate parity is achieved if the precisions (or positive predictive values) in the subgroups are close to each other. The precision stands for the number of the true positives divided by the total number of examples predicted positive within a group.&lt;/p&gt;
&lt;p&gt;Formula: &lt;strong&gt;TP / (TP + FP)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Let's compute predictive rate parity for the first model that uses all features:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred_rate_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                         &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                         &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                         &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                         &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                         &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Caucasian&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res1&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Precision&lt;/th&gt;&lt;td&gt;0.6863158&lt;/td&gt;&lt;td&gt;0.6681223&lt;/td&gt;&lt;td&gt;0.7857143&lt;/td&gt;&lt;td&gt;0.6967213&lt;/td&gt;&lt;td&gt;0.6666667&lt;/td&gt;&lt;td&gt;0.6489362&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Predictive Rate Parity&lt;/th&gt;&lt;td&gt;1.0000000&lt;/td&gt;&lt;td&gt;0.9734910&lt;/td&gt;&lt;td&gt;1.1448291&lt;/td&gt;&lt;td&gt;1.0151614&lt;/td&gt;&lt;td&gt;0.9713701&lt;/td&gt;&lt;td&gt;0.9455358&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The first row shows the raw precision values for all ethnicities. The second row displays the relative precisions compared to Caucasian defendants.&lt;/p&gt;
&lt;p&gt;In a perfect world, all predictive rate parities should be equal to one, which would mean that the precision in every group is the same as in the base group. In practice, values are going to be different. The paritiy above one indicates that precision in this group is relatively higher, whereas a lower parity implies a lower precision. Observing a large variance in parities should hint us that the model is not performing equally well for different sensitive groups.&lt;/p&gt;
&lt;p&gt;If the other ethnic group is set as a base group (e.g. Hispanic), the raw precision values do not change, only the relative metrics:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res1h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred_rate_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                          &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                          &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                          &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                          &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                          &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Hispanic&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res1h&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Precision&lt;/th&gt;&lt;td&gt;0.6967213&lt;/td&gt;&lt;td&gt;0.6863158&lt;/td&gt;&lt;td&gt;0.6681223&lt;/td&gt;&lt;td&gt;0.7857143&lt;/td&gt;&lt;td&gt;0.6666667&lt;/td&gt;&lt;td&gt;0.6489362&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Predictive Rate Parity&lt;/th&gt;&lt;td&gt;1.0000000&lt;/td&gt;&lt;td&gt;0.9850650&lt;/td&gt;&lt;td&gt;0.9589520&lt;/td&gt;&lt;td&gt;1.1277311&lt;/td&gt;&lt;td&gt;0.9568627&lt;/td&gt;&lt;td&gt;0.9314143&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Overall, results suggest that the model precision varies between 0.6489 and 0.7857. Apart from the &quot;other&quot; category, the lowest precision is observed for African-American defendants. This implies that there are more cases where the model mistakingly predicts that a person will commit a crime among African-Americans than among, e.g., Asian defendants.&lt;/p&gt;
&lt;p&gt;A standard output of every fairness metric function includes a barchart that visualizes the relative metrics for all subgroups:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res1h&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric_plot&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
56Y7/tqy2THTp4xeds6j5x7/X89cs6B3737pFd/esVLv90b77zaoZ8ajs7vyW7zzhoknTvvW
tOMvvHjQW+/vHlimoaGh9GQcQigUCu3t7e/xC9+XZY/+tfM0sEwNjhxqb+pisVg7Iy8/ae1M
XVJr84Yy/2yvhfdnaUlr4cLKrfpHyw785OkHbpr62ePzSv9b17xlsdh738NPv/b3N1+e+eD3
z7w5hPDMcy93FYvJROh845W33vrXD0lJ1B2/2/pP/eC8BZntjtzknaKqa9ntuB373zrx2w88
8dzsl56+/drJNz78xx2H9F3VGrreuvOJJT27ffkTy5+5w/H7FfKLrnrhve73er832mfwSfv0
K06edPmTf3h59h+fnXreZe3Fj+zQlFnNPfAeVwIA1Kbqh10IiaPOO6V52SFr/UdNPOozv73+
B189+fRrfvbkARMv/8bnhz03/Zp5PYXtR+2VnTP1lG9dt8LXb/XFT/cs/NsmI49dfpgRZ19+
7D5977jmom9MuujBl+q/dsEluzSv8tDOP/3k7lT9h8Zt+y8R1jTw8B2b6/4w9dH3Psn7utGQ
SE+47Hv79v/7j7836YzzfvjX9T9x3ne/lFjtPfDeVwIA1KBEDe6lXLMKPW+3d9a19anCG4J6
OxYtTDW3ZVfypsXyvRTb0tJyzwvZfD7f3d1dju2vnbLZbKFQyOVy1V5I5TQ2NoYQcrlcrU3d
1dVVU8fY1dfXhxBqaupUKpXNZjs61rpjwsonk8lkMplisVi+Y+z232atuz8bGxvT6fTixYur
vZCyaGtrW9VFNfRBPmWSrGtuq9K7vNONfVb5jQUAak8Nhd3SN24474cvrvSi+r6fnHzG/hVe
DwDAmlVDYde00ZgLL6z2IgAAymZtePMEAABrgLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISw
AwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiE
sAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCI
hLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMA
iISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiES62gtg3TNq
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
VERC2AEARELYAQBEQtgBAETC34rlfZv852vy+Xx3d3e1F1I52fZsoVDI5XLVXkjlNC5qDCHk
crlam7qrq6tQKFR7IRWSTCbr59eHEGpq6lQqlX0r29HRUe2FVE4mk8lkMsVisab+9HMmk0km
k9V9qjp9oy9U/kbtsQMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLAD
AIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISw
AwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiE
sAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCI
hLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLAro2J+8TEH
jxo5cuT9C7re9cr5rtkjR4489fY55V8XABAnYVdGC2ZdtaC32D+T/OWMOe965US6dfjw4XsN
bi3/ugCAOAm7Mnpk6rMN6486aae2v/3musK7XTmZbhs3btzoHderxMoAgBilq72AaOW7X71+
zuJtJnxm68E9uZPvuvWNjiM2aixd9NbMe6+48c6X/vpGoqn/DnsN/9pxo+oSIYQwZvSoHaZM
O23jlp4lL0ydcsNjL7yyJJcaMHDwAV8YP2r3DUpXGHn5JW/fPG3mX2bPW5LZ47NjTz5saBVn
BADWKsKuXOY9enWumD522AbNdV9cv+7e39zw0hFn7BxC6O2Y9bVzfrTFgcd8/Usf6Zz7wlVX
Xn/uRrucP3zT5b/2htO//UjjsGPHH7lxc/ezD8+47junDJsxfUAmGUJ48LtTDp8wccygfvNn
3XncmRdust+tB7XVl77qlltumTlzZul0Y2PjN7/5zXLMlclkQgjJZDKbzZZj+2unZDKZSCSS
yZrbw51KpWpt6rq6umKxWO1VVFrp33WNSCQSIYSaegQrjZxIJGpq6tJjV3VHbmlpKcdmV/8Y
JezK5Z5pf2re5Mgt6lMhNIzduu9FT17dVbyiPpHoefvJRfnCiIM+t3OfurDtVh9qHTC3vnmF
r13vkweN3//Aj/WpCyFsPig17e5z/tzVOyBTF0JI7XLinoP6hRD6f2TElg3XP/tmx7Kwe/75
5//7v/+7dLpfv36TJk0q33SJRCKVSpVv+2uh0iNjram1qgs1OXIIodb+OYeaHDnU5NTVHblM
WZnP51dzqbAri54lT/7yrc6txm7+6quvhhD67Ldp/g8zr5u9+MTBfRr6j/r4oAfOHzt2x2F7
7rDddnvts9fQxhV/7A4+ZPScl2c9+NicOXNmz3ru8eUv2mDY+stO1ycSYblqHzx48O677146
3dTUlMvlyjFa6R9JsVisqb0apaqrqZFLfVNr3+hkMlkovOsBsVEpfaNrcOqaGjmRSJQexGpt
6lDtx+0yPREXCoXVBKuwK4u5d08vFot/vHby+Gv/eebjU2eeeME+iVTrNy657sCZjz/1zMyn
7rvxxquv+vhh3zrtsO2WXa2YX3TFpFMferNl6O67Ddl+z70PGHrKyecvu7Quu8rdCWPHjh07
dmzpdKFQaG9vX/OD/WPHcqFQ6O7uLsf2107ZbLZQKJTpn+jaqbGxMYTQ29tba1P39PTUzpNf
Mpmsr68PIdTU1KlUKpvNdnW9+6dQRSOTyWQymWKxWGtTJ5PJ6j5VLVq0qExbXs2+QGFXFjfd
8deWzY6ZPmX0snMePff4/3rmmgW9eyf/9+5fPNE95oujt9ppzxDC/97x9dN/cvVph12y7JpL
5l51//MLpt52dVsmGULoar+v8usHANZFtXg0Sbl1vXXnE0t6dvvyJ5Y/c4fj9yvkF131wvx0
y+Kf3X7Dxbfd94eXZz/7+IN3//pvTZv8yztb65q3LBZ773v46df+/ubLMx/8/pk3hxCeee7l
rlp6RQwA+ADssVvz/vSTu1P1Hxq3bd/lz2waePiOzbf/YeqjTZcece5xndfddet5Ny3ItPTf
apf9v33CIctfs77/qIlHvXbN9T/4eVd6i62GHDrx8n3umTJ9+jXzdr2osnMAAOuYRE0dGR2Z
3o5FC1PNbdmVHEFZ1mPsvjN3Wj6fd4xd3ErH2OVyuVqbuqurq3aONlt2jF1NTV06xq6jo6Pa
C6mcZcfYdXZ2VnstlbM2HGN3+kZfKNOW29raVnWRPXbrsHRjn1V+YwGA2uMYOwCASAg7AIBI
CDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCA
SAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsA
gEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7
AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgI
OwCASAg7AIBICDsAgEgIOwCASCSKxWK118CaVygU2tvby7HllpaWbDbb09OzePHicmx/7dTa
2prL5To7O6u9kMrp379/IpFYunRprU29aNGi3t7eai+kQtLpdN++fUMICxcurJ2pM5lMa2vr
/Pnzq72QymloaGhqairf88LaqbGxMZ1Ox/pU1dbWtqqL7LEDAIiEsAMAiISwAwCIhLADAIiE
sAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiES62gtg3fO/Myfn8/nu7u5qL6Ry
5mezhUIhl8tVeyGVs7CxMYSQy+Vqbequrq5CoVDthVRIMpl8q74+hFBTU6dSqWw229HRUe2F
VE4mk8lkMsVisax/+nngVqeXb+O8d/bYAQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEARELY
AQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEARELYAQBEQtgBAERC
2AEARELYAQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEARELYAQBE
QtgBAERC2AEARELYAQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEA
RELYAQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEARELYAQBEQtgB
AESiomFXzC8+5uBRI0eOvH9B1/Lnd/ztwW+c8MVDjz5zhevnu2aPHDny1NvnVH2Fa1DlhwIA
akRFw27BrKsW9Bb7Z5K/nDFn+fP/ePmNb9QfcNFFp69w/US6dfjw4XsNbq36Ctegyg8FANSI
iobdI1OfbVh/1Ek7tf3tN9cVlju/u72nadOPbjqg3z/PKuZfe2VeMt02bty40TuuV/UVrhlV
GgoAqBHpit1SvvvV6+cs3mbCZ7Ye3JM7+a5b3+g4YqPGEMIvTzhi6t+Whr+eOfr3g3824wdj
Ro866NJzH5l0/uzu7W+bPmnM6FE7TJl22sYthZ55t1x25UPPvdiea9hyp31OGH/0ZvWpEELP
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
AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQ
dgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACR
EHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkUhXewGsez684+Senp7FixdXeyGV09ramsvlOjs7
q72Qyunfv38ikVi6dGmtTb1o0aLe3t5qL6RC0ul03759QwgLFy6snakzmUxra+v8+fOrvZDK
aWhoaGpqKhQK7e3t1V4LZWePHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQd
AEAkhB0AQCSEHQBAJIQdAEAk/K1Y3rfeB+4u5vN13d3VXkjlFLPZZKFQl8tVeyGVk29sDCEk
c7lamzrd1ZUsFKq9kApJJpO99fUhhJqaOpVK5bPZuo6Oai+kcpKZTG8mUywW69buP/3cs+e+
1V5CDOyxAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCI
hLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMA
iISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLAD
AIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISw
AwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsFulnx5/+NGn/H6FM39/
ytGHHzc9hJDvmj1y5MhTb59T7mVU7IYAgHVdutoLWFcl0q3Dhw9ff3BrNDcEAKzrhN0HlEy3
jRs3LqYbAgDWdcLugxszetQOU6adtnHLWzPvveLGO1/66xuJpv477DX8a8eNqkuE7kW/PfSL
U2695owfXHrLC398rc+mW3zui6cM/+j6IYSeJS9MnXLDYy+8siSXGjBw8AFfGD9q9w1KGxx5
+SVv3zxt5l9mz1uS2eOzY08+bOjyN1TomXfLZVc+9NyL7bmGLXfa54TxR29Wn6ryvQAArDWE
3erku/764ovNy5/z1678Ctfp7Zj1tXN+tMWBx3z9Sx/pnPvCVVdef+5Gu5w/fNPSBiae+ctD
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&quot; width=&quot;420&quot; height=&quot;420&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Some fairness metrics do not require probabilistic predictions and can work with class predictions. When predicted probabilities are supplied, an extra density plot will be output displaying the distributions of probabilities of all subgroups and the user-defined cutoff:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res1h&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Probability_plot&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
RK5CYII=&quot; width=&quot;420&quot; height=&quot;420&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let's now compare the results to the second model that does not use ethnicity as a feature:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# model 2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred_rate_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                         &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                         &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                         &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                         &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                         &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                         &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Caucasian&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Precision&lt;/th&gt;&lt;td&gt;0.690678&lt;/td&gt;&lt;td&gt;0.6609808&lt;/td&gt;&lt;td&gt;0.8181818&lt;/td&gt;&lt;td&gt;0.706422&lt;/td&gt;&lt;td&gt;0.6666667&lt;/td&gt;&lt;td&gt;0.6625000&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Predictive Rate Parity&lt;/th&gt;&lt;td&gt;1.000000&lt;/td&gt;&lt;td&gt;0.9570029&lt;/td&gt;&lt;td&gt;1.1846068&lt;/td&gt;&lt;td&gt;1.022795&lt;/td&gt;&lt;td&gt;0.9652352&lt;/td&gt;&lt;td&gt;0.9592025&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can see two things.&lt;/p&gt;
&lt;p&gt;First, excluding &lt;code&gt;ethnicity&lt;/code&gt; from the features slightly increases precision for African-American defendants but results in a lower precision for a number of other groups. This illustrates that improving a model for one group may cost a fall in the predictive performance for the general population. Depending on the context, it is a task of a decision-maker to decide what is best.&lt;/p&gt;
&lt;p&gt;Second, excluding &lt;code&gt;ethnicity&lt;/code&gt; does not align the predictive rate parities substantially closer to one. This illustrates another important research finding: removing a sensitive variable does not guarantee that a model stops discriminating. Ethnicity correlates with other features and is still implicitly included in the input data. In order to make the classifier more fair, one would neet to consider more sophisticated techniques than simply dropping the sensitive attribute.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In the rest of this tutorial, we will go through the functions that cover the remaining implemented fairness metrics, illustrating the corresponding equations and outputs. You can find more details on each of the fairness metric functions in the package documentation. Please don't hesitate to use the built-in helper to see further details and examples on the implemented metrics:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt;fairness&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred_rate_parity&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Demographic-parity&quot;&gt;Demographic parity&lt;a class=&quot;anchor-link&quot; href=&quot;#Demographic-parity&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Demographic parity is one of the most popular fairness indicators in the literature. Demographic parity is achieved if the absolute number of positive predictions in the subgroups are close to each other. This measure does not take true class into consideration and only depends on the model predictions.&lt;/p&gt;
&lt;p&gt;Formula: &lt;strong&gt;(TP + FP)&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_dem&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dem_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Caucasian&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_dem&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Positively classified&lt;/th&gt;&lt;td&gt;147&lt;/td&gt;&lt;td&gt;504.000000&lt;/td&gt;&lt;td&gt;2.00000000&lt;/td&gt;&lt;td&gt;22.0000000&lt;/td&gt;&lt;td&gt;1.000000000&lt;/td&gt;&lt;td&gt;10.00000000&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Demographic Parity&lt;/th&gt;&lt;td&gt;  1&lt;/td&gt;&lt;td&gt;  3.428571&lt;/td&gt;&lt;td&gt;0.01360544&lt;/td&gt;&lt;td&gt; 0.1496599&lt;/td&gt;&lt;td&gt;0.006802721&lt;/td&gt;&lt;td&gt; 0.06802721&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_dem&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric_plot&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAIAAAByhViMAAAABmJLR0QA/wD/AP+gvaeTAAAg
AElEQVR4nOzde5zUdb348c9c987uyoqKmiKpqUHeMEGT1DKLQESPl9QQb2QimZZpchAvmafS
TBRLxRvhhbSLpqKeU2Y/r3lBUzQ7ERpqErAsy8LeZub3x+KKHFjEWAY++3z+4WOc+c533vPd
ubz2O99ZEoVCIQAAsOlLFnsAAADWD2EHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEH
ABCJdLEHoFsUCoXFixd3x5rLy8szmUxbW9uyZcu6Y/2blqqqqubm5ra2tmIPUmTpdLqioiKE
0NjYmM/niz1OkWWz2Uwm09TUVOxBiq+ysjKVSrW0tDQ3Nxd7luKrrq5eunRpLpcr9iBFls1m
y8rKQggNDQ3FnqX4SktLE4nE8uXL1/WKtbW1a7pI2MWpUCh038tHMplMJBJenkIIiUQin8/b
FMlkMplMhhBsjQ6eIB0SiUTHA8PWCCEkk0lPkBBCoVDwqFjF+t0UPooFAIiEsAMAiISwAwCI
hLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMA
iISwAwCIhLADAIhEutgDsOlpu3dJPpfLtLSvZbHPeXQBwAZljx0AQCSEHQBAJIQdAEAkhB0A
QCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQd
AEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSE
HQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAk
hB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBA
JIQdAEAkhB0AQCSEHQBAJIQdAEAk0sUeIGKFFx78+YNPvfK3OXNas3U77LDDp/b/4uFDd0us
btHRo0YOnDztnK2rNvSMAEBE7LHrFoX2hddNHDvp+gcr++1x3NfO/dpxw7evXnLbld/9xhW/
Kry3zINjv3LGda8Vc0oAIC722HWLJ358/sOvpi64+oZ9tq3oOGe/g774hX3vPvOSWy7dbZ//
PHTr9XMzhdxbby7cers+62dtAMAmTtitf7nmOT/+f+8OGH9dZ9V16Lv3kd/a96Ef3XptOPSy
n5141P2LmsM75/7H4/v94uffCSHk2+tv+68fPPbyX5anaj596JjxxwwOIRRySx649bqZT736
9uK2vv0Hjhx92sGfqA0hjB418vCrL35i4qVzWj559/SJHetftGjR8uXLO2+uvLy8O+5dIpHo
+G8yuZbdvalUqjsG2Ngkk8keck+70PlgWOujoidIJBKJRMKjIqz0cmFrdPByEd57VIQe8x7R
tY/2clEoFLq4VNitf0vfvqe1UDhuyGp2pH3yK59qe/LhWU1tJ18/bctxJ84ccP5Vp+3ScdFz
l/znF48+48LjR7/yx7un3P79fofMGL5Z6a8njv/F4p1PO+2cbavC7Cd+e/V5Yws/veVzW5aH
EB648OohR3zj1AE7d678yiuvnDlzZsfp2traRx55pJvuYFtoTiaTpaWlXS+Wqe3VTQNsVCor
K4s9wkakurq62CNsLGpra4s9wsaitLR0rS8XPUSvXj3iVfFD8hzpVFJSsk7L53K5Li4Vduvf
8ncWJxKJHctWs20zvXYM4eG/LW/fvaIsm0gk09mSkkzHRbW7nz36858KIWx7zHm/vvvwFxY0
f77w8C0v1196+7cGVGRCCP13HpB6/vjbp8z+3MV7hxCy+55z4rBdNuDdAgA2dsJu/SupKysU
Cm+35rbJrrpzNd/6TgihLrOaj6u2/sJ2naer08kQwtJ5zxUKhQuOPWLlxSpa5oWwdwhhy89u
tcoavv71rx933HEdpxOJxOLFi//de7I6FRUVIYR8Pt/a2tr1kk2L890xwEalV69ey5cvb2tr
K/YgRZZOpzv2XC5ZsiSfj//n3rWSkpJMJrN06dJiD1J8VVVVqVSqpaVl5aNEeqyamprGxsau
97X0BNlstuNIoW56k9q0lJWVJRKJZcuWrdO1CoVCF/s7hd36V7n1sETiT3e8XP/tPetWuejv
v3k2le07pNdqdrqWla9agenyTDJVdccdU1f+CymJZGZNy/ft27dv374dp/P5/KJFiz76fViz
fD6fDKFQKKz1/bu9vb07BtioFAqFXC7XE+5p1zoPmsnlct63MplMoVDwqAjvHQmUz+dtjQ5e
LkII6fSK8LApQgj5fD6RSKzfTeFI5/UvU7nHKbvWPP2jH/2l/gP7tBr++j/ff3Dex0edk1nt
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
81Bom/r0v3Y5c3gIoXnhvbe8XH/p7d8aUJEJIfTfeUDq+eNvnzL7cxfv3cVID077a+U2x+1Q
mgqhbMzONVc8e0NzYUrpe+/Zmx8zZsfqbAhh36O2m/L0rInHfyadCKHmE4fUlDzxakPYe/Ou
bzS77zknDttl5ZtrnHfTo/PbL799/C7l6RDCdpcsvOCy3y1oO7Yuk1z9FshkQwipvU7fr19t
CKH3rsN3LLvlxXeXdYbdnXfeOXPmzI7TtbW1jzzyyEf94axdMpmsqqrqvvVvQsrKyoo9wkak
oqKi2CNsLDxBOmWz2Ww2W+wpNgqeICvzHOmUyWTWvtBKcrlcF5cWLexCCHV7jj1p4FM3T7j2
s1O/tfL5Rxw5au7rsx99au7cuXNmv/R0F2tIpKpO3W2zKbc+E/Ya1jhv+pttZRP27RNCWDrv
uUKhcMGxR6y8cEXLvBDWGHatjc/+ZsHyncZs/+abb4YQqg/eNvfnWTfPWXJ6/+qOBaq2X/GE
TGZTycwWVe99glyaTIRCWOuNbvnZrVa5xYVPv5ap3LOj6kIIZXVfvvLKL691C2wxZPPO06WJ
FTcNABCKG3YhhGHfPf++E75z0S/+Ovq9cwq5hikTz37s3arB+wwa8Mn9Djh08FlnXtrFGgac
PLjxrGnz27449+b/t9knv9bxeWW6PJNMVd1xx9SVPyFLJLsq4nkPTC8UCn+5adK4m94/8+mp
s06/bOiHvC9d32hZ+aq73/Nt+URiNSN1vQWyJWv8vssFF1xw7rnnrlhJobBw4cIPOfk6qaqq
CiGby+UWLlzcHevftNTU1Cxbtqy1tbXYgxRZJpPp1atXCKG+vt5HsWVlZZlMZsmSJcUepPiq
q6vT6XRzc3NTU1OxZym+3r17NzQ0tLe3F3uQIispKamsrAwhdNOb1KaloqIikUgsXbp0Xa/Y
u3fvNV1U5LBLl+108df3PX3yxKf2ruw4p3He9Q+/XD/17hvqMskQQvOih7peQ9XHRm+beWDq
y2/NeWnhgVft0XFm+ZZfKOT/dP+/2o/cdsVqf3nl5fWDTzp5cJ81ref2e/9Rtd2J0yeP6jzn
yYtP+a8XbqxvP6A2/aGOoFrXG+09qF/rjCfnNOd2WPGFiWfO+e60Uy6/st+CddsCncrKyjo/
Fszn84sWLfqQV1wnnR/td/0Zf89RKBRsipW3gK3RsQVsh06eI51sipXZFKF7Xi6K/y9P9D3o
3MO2Tf3y6fkd/5ut3LFQaH/o8eff+te7r8969Efn3xFCeOGl15sLhWQiLH/njQULPvhHUhLZ
UwZt/tyPL6nP7HbcNiuKKls16OTde9814XuPPPPSnNeev+emSbc9/pfdB9SsaYbmBfc909g6
6GsHrnzmwFMOzucarn/lw/5Ksa43Wt3/jKG1hUkTr332z6/P+cuLUy+5ZlFh14EVmS62wIec
BADomYofdiEkjr/krMrOQ9Z6j5xw/Bf+cMuPv3HmuTf+8tlDJ1z77S8PeWn6jfNb858cuX/J
3KlnfffmVa6/01c/37r4n9uMOGnlOzP8wmtPGlpz741XfHviFY++VvrNy67aq3KNR+/+9ecP
pEo/NnaXD0RYRd9jdq/M/nnqkx/+nqzTjYZEevw1P/xs73/97IcTz7vkJ//Y/MBLfnBqosst
8OEnAQB6oIR9of+mfOvSRcuzddVF+M5X+7KGxanKupLVfHm++z6KraqqevCVklwuN7RffXes
f9NSW1vb1NTkGLtMJlNdXR1CqK+v7/rrWj1BWVlZNpttaPiIf4A9JjU1Nel0evny5Y6xCyHU
1dUtXrzYMXalpaUdx9gtWLCg2LMU30c+xq6urm5NFxX5GLsIJLOVdUX6In+6vHqNP1gAoOfp
QWHX9M6tl/zk1dVeVFpz0KTzDtnA8wAArF89KOwqthp9+eXFHgIAoNtsDF+eAABgPRB2AACR
EHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAA
kRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYA
AJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2
AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQ
dgAAkRB2AACREHYAAJFIF3sANj0j9wytrbklS4o9BwDwQfbYAQBEQtgBAERC2AEARELYAQBE
QtgBAERC2AEARELYAQBEQtgBAERC2AEARELYAQBEwj8pxjqbNPfNXC7X0tKyHtd5bp+69bg2
AOiZ7LEDAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiE
sAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCI
hLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMA
iISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLAD
AIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwW6NfnHLMCWf9aZUz/3TW
CcecPD2EkGueM2LEiLPvmdvdY2ywGwIANnXpYg+wqUqkew0bNmzz/r2iuSEAYFMn7D6iZLpu
7NixMd0QALCpE3Yf3ehRIwdOnnbO1lULZs2cctt9r/3jnURF74H7D/vmySOzidDS8Iejvjr5
rhvP+/HVd77yl7eqt93hS189a9inNg8htDa+MnXyrU+98kZjW6pP3/6HfmXcyH226FjhiGuv
WnrHtFl/nzO/MbPvF8ecefTglW8o3zr/zmuue+ylVxe1le24x9DTxp2wXWmqyFsBANhoCLuu
5Jr/8eqrlSuf84/m3CrLtC+b/c2LfrrDYSd+69Rdl8975frrbrl4q70uHbZtxwomnP+boyZ8
5zvblL/y+7smXjg2N/m2EdtW3nru954oH3LSuOO2rmx58fEZN3//rCEzpvfJJEMIj/5g8jHj
J4zuV7tw9n0nn3/5NgffdXhd6YpbKrT/ZNz45yr2OeMbk2pT9fded/WECZlpPzquc5LHHnvs
73//e8fpkpKS4cOHd8c2SaVSIYRkMpnJZNbjasvKytbj2jaYRCJRUlLSsU16ss4tUFJSUigU
ijtM0WUymWQyuYk+pNevZDIZQkin07ZGh5KSkvX7yrkpSqdXhIdHRQghnU4nEol13RRdv8wK
u64sffuW73xn1TPLN//A/7YufbYhlx9++Jf2rM6GXXb6WK8+80pXtGChkNvyjG/ss31dCGHA
5086/Xd/mD752RE/+OxmBx0+7pDDPl2dDSFs3y817YGL/tbc3ieTDSGk9jp9v361IYTeuw7f
seyWF99d1hl2jfNuenR+++W3j9+lPB1C2O6ShRdc9rsFbcfWZVZ8A+bhhx+eOXNmx+na2tpj
jjmmO7ZJh0QisX5fnioqKtbj2jakkpKSkpKSYk+xsSgvLy/2CBuLTfchvd5lMhk100HKrMxz
pFNn7H5Iudyq+5g+sLZ/b5jIVe/wn9OuGrTyOX8664QrGj+wTFnvkZ/p98ilY8bsPmS/gbvt
tv/Q/QeXv7//5qAdqztP7/rZLZpuezSEzx5x5Ki5r89+9Km5c+fOmf3S0yuvbYsh72djaSIR
VoryhU+/lqncs6PqQghldV++8sovr3zdzTbbbOutt14xeXV11z/4j6zjV/Cwtt8Y1lU3Tdvd
UqlUPp+3jyqRSHQ8MDbRn+P61bEp8vl8sQcpvmQymUgkCoWCrRG8XLzHy8XKPtrLRT6f7+KT
ImH370qken37qpsPm/X0cy/Meu6h22674frPHP3dc47erePS9pWew/nWfMi3FXINUyae/di7
VYP3GTTgk/sdcOjgs868tHOZbMka/wBNvi2fSHT1W+/ZZ5999tlnr1g4n1+0aNG/dcfWoKqq
KoSQy+VaWlrW42rr6+vX49o2mNra2qamptbW1mIPUmSZTKa6ujqEsGTJEi/WZWVl2Wy2oaGh
2IMUX01NTTqdbm5ubmpqKvYsxVdXV7dkyZL29vZiD1JkpaWllZWVYZN92V+/KioqEonE0qVL
1/WKdXV1a7rI37H7dzW8dv+t0+7daY/9jj3pjO9dNfVHJ271+D03dF760PPv19UfH3qnbKsD
Gudd//DL9dded+VZpx138H579636sI/s3oP6tS59bs57B/m1Nj5z5plnvtjUth7vCwCwSbPH
7t+Vrlryy3vuXFhe8fmBO+br3/zD7/5Zsc3731p4+ZqJdxdO+dRWpa/8/q4Z/2ga+7PPZDPL
C4U/PvT485/dbdumt16dcd0dIYQXXnp9jyG7dX1D1f3PGFr7xKSJ144/4dDNsssfmnrNosLg
gRWOXAEAVhB2/66KrY+9+OTlN99/1yW312eqeu+01yHfO+3IzksvvOTYu26cds/c+TXb7nDy
hT/90pblIYyccPxbN97y4181p3fYacBRE64d+uDk6dNvnL/3FWu5pUR6/DU/vG3yDT/74cSG
fPnHP3XgJWeckOjeOwcAbEoSDuTsJi0Nf/iPE66Ycvevtsl+xL+F0b6sYXGqsq7ko1y9W4+x
+/477673Y+zO7bPGwwU2Zo6x69B5jF19fb1j7Bxj16njGLvly5c7xi6EUFdXt3jxYsfYdR5j
t2DBgmLPUnzdcYydPXYbr3R59SYZOwBAkfjyBABAJOyx6y4l1UPvvXdosacAAHoQe+wAACIh
7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAi
IewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAA
IiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewA
ACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHs
AAAiIewAACIh7AAAIpEu9gBseiZt/7HW1tYlS5YUexAA4APssQMAiISwAwCIhLADAIiEsAMA
iISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhH8rlnU26W835nK5lpaWc7f6
SrFnAQDeZ48dAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQd
AEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSE
HQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAk
hB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBA
JIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEXTcq5JaceMTIESNG
PFzfvNaFc81zRowYcfY9c7t/LgAgTsKuG9XPvr6+vdA7k/zNjLlrXTiR7jVs2LD9+/fq/rkA
gDgJu270xNQXyzYfecYedf/8/c35tS2cTNeNHTt21O6bbYjJAIAYpYs9QLRyLW/eMnfJJ8Z/
Yef+rW1n3n/XO8uO3aq846IFs2ZOue2+1/7xTqKi98D9h33z5JHZRAghjB41cuDkaedsXdXa
+MrUybc+9cobjW2pPn37H/qVcSP32aJjgRHXXrX0jmmz/j5nfmNm3y+OOfPowUW8jwDARkXY
dZf5T97QVkifNGSLyuxXN8/O/P2trx173p4hhPZls7950U93OOzEb5266/J5r1x/3S0Xb7XX
pcO2Xfm6t577vSfKh5w07ritK1tefHzGzd8/a8iM6X0yyRDCoz+YfMz4CXMmYV0AACAASURB
VKP71S6cfd/J51++zcF3HV5X2nGtO++8c9asWR2ny8vLv/Od73TH/cpkMiGEZDJZUlJSVVXV
HTexCUkmk2VlZSUlJcUepMiSyRX7/isqKgqFQnGHKbpUKpVMJj07QgipVCqEkM1mOx8hPVxF
RUU+v9bPbyLX8agIIXiOhBDS6XRY903R9cussOsuD077a+U2x+1QmgqhbMzONVc8e0NzYUpp
ItG69NmGXH744V/aszobdtnpY736zCutXOW6mx10+LhDDvt0dTaEsH2/1LQHLvpbc3ufTDaE
kNrr9P361YYQeu86fMeyW158d1ln2L388sv//d//3XG6trZ24sSJ3XfvEolEKpUSNOG90qVD
Npst9ggbC8+OTqlUqvO9vIfzcrEyz5FO6/oEyeVyXVwq7LpFa+Ozv1mwfKcx27/55pshhOqD
t839edbNc5ac3r+6rPfIz/R75NIxY3Yfst/A3Xbbf+j+g8tX/YkeceSoua/PfvSpuXPnzpn9
0tMrX7TFkM07T5cmEmGlau/fv/8+++zTcbqioqKtra077lrH469QKBQKhW66iU1IOp3O5XL2
USUSiY7fO9vb222NZDKZTCbb29uLPUjxpdPpRCKRz+e7fh/qITKZjCdICCGZTHa8j3gHCe+9
pa7rEySfz3fRgsKuW8x7YHqhUPjLTZPG3fT+mU9PnXX6ZUMTqV7fvurmw2Y9/dwLs5576Lbb
brj+M0d/95yjd+tcrJBrmDLx7MferRq8z6ABn9zvgEMHn3XmpZ2XZkvW+InGmDFjxowZ03E6
n88vWrRo/d+x9/YY5/P5lpaWhoaG7riJTUhtbe2yZctaW1uLPUiRZTKZ6urqEEJjY6O38LKy
smw269kRQqipqUmn0y0tLU1NTcWepfjq6uqWLl2q+EtLSysrK0MIniMhhIqKikQisXTp0nW9
Yhf7O4Vdt7j93n9UbXfi9MmjOs958uJT/uuFG+vbD0j+7wO/fqZl9FdH7bTHfiGE/733W+f+
/IZzjr6qc8nGedc//HL91LtvqMskQwjNix7a8PMDAJsiB7Suf80L7numsXXQ1w5c+cyBpxyc
zzVc/8rCdNWSX95z65V3P/Tn1+e8+PSjD/zunxXbfOCbrdnKHQuF9ocef/6tf737+qxHf3T+
HSGEF156vbnH78AHALpmj93699efP5Aq/djYXWpWPrOi7zG7V97z56lPVlx97MUnL7/5/rsu
ub0+U9V7p70O+d5pR668ZGnvkROOf+vGW378q+b0DjsNOGrCtUMfnDx9+o3z975iw94PAGAT
k3Ag56arfVnD4lRlXclqjqDs1mPsvj9vWi6Xa2lpOXerr3THTWxCamtrm5qaHGPXeYxdfX29
Y+wcY9ep4xi75cuXO8YuhFBXV7d48WLH2HUeY7dgwYJiz1J8H/kYu7q6ujVdZI/dJixdXr3G
HywA0PM4xg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4A
IBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIO
ACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLC
DgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACAS
wg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLpYg/ApmdS/1NaW1uXLFlS7EEA
gA+wxw4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLC
DgAgEv6tWNbZ/86alMvlWlpaij1I8dWXlbW2tuZyuWIPUmSpVOpfJSUhhObm5nw+X+xxiiyT
yaRSqebm5mIPUnyLSkuTyWR7e3tra2uxZym+xfPKPUFCCOl0OpvNhhCWLVtW7Fm6Xd+dzt3w
N2qPHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQd
AEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSE
HQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAk
hB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBA
JIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkNmjYFXJLTjxi5IgRIx6ub175
/GX/fPTbp331qBPOX2X5XPOcESNGnH3P3KJPuB5t+DsFAPQQGzTs6mdfX99e6J1J/mbG3JXP
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
LVu2rNizdLu+O636T2qtouMYu6VLl67rmuvq6tZ00Yb7cyfFlS6vXuM2+Pcks5V1RYi6ELrz
TgEAm6KeEnYhhKZ3br3kJ6+u9qLSmoMmnXfIBp4HAGD96kFhV7HV6MsvL/YQAADdJv6/+wwA
0EMIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7
AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgI
OwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBI
CDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCA
SAg7AIBICDsAgEgIOwCASKSLPQCbno/vPqm1tXXJkiXFHqT4amtrm5qaWltbiz1IkWUymerq
6hBCfX19Lpcr9jhFVlZWls1mGxoaij1I8dXU1KTT6eXLlzc1NRV7luKrq6tbvHhxe3t7sQcp
stLS0srKyhDCggULij1LnOyxAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLAD
AIiEsAMAiISwAwCIhLADAIiEfyuWddb+yAOFXC7b0lLsQYovX1aWam3N9vh/HTWVSrWXlKQ/
/6ViDwLQ09ljBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlh
BwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJ
YQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQ
CWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcA
EAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABCJdLEHKI5Cftmjd09/
8A9Pv/HuwkyvPtt9fM+jvnrCp7YpL+JIueY5hx911sdHX33lEdsXcQwAYNPVE8OukGuc8p2v
//fckuFHfvnwHT+WX/LuEw/dNekbz1xw45S9a0uKNVUi3WvYsGGb9+9VrAEAgE1dTwy7v0yb
+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
EsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4A
IBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIO
ACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLC
DgAgEuliD8CmJ/35L+VbW1uXLCn2IMVXUVuba2pqbW0t9iBFlslkKqqriz0FAPbYAQDEQtgB
AERC2AEARELYAQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEARELYAQBEQtgBAERC2AEARELY
AQBEQtgBAERC2AEARELYAQBEQtgBAERC2LFuLrzwwgMPPPCCCy4o9iAbhcWLF7e2thZ7iuJ7
6aWXDjzwwAMPPPCdd94p9izF19zcvGTJkmJPsVE49dRTDzzwwClTphR7kI3CwoUL29vbiz1F
8c2cOfPAAw886KCDij3IRmHZsmVNTU3rd53p9bs6NhLJZLKurq471pzP5xsbG/P5fDetn01R
RUVFY2NjCKGmpsYDg06tra2NjY2JRMKjgk4lJSWNjY3d9yaFPXYAAJEQdgAAkfBRLOtm4MCB
yWRy1113LfYgbERqa2s/97nPhRDKyv5/e3ceFlXZ/gH8PrMPwwzDKgiIgLK6oFRuiIAgUZhr
kq9oBGruuVGKu2iiplFmKpZi8hZaSuLPLfc091KkRNQQcyOQXRiYGeb8/hgYQBLB1xoavp8/
uHiec84z3zPXpXPznHOeEes7C7QgPXr0sLe3d3Fx0XcQaEHatm0bGBjIMIy+gxgshmVZfWcA
AAAAgBcAl2IBAAAADAQKOwAAAAADgXvsoHnO71i34+Tle6VcV4/uo6eMdZHy9Z0IWopN74RJ
Vm4NtzLSdxDQP436UeqXmw5dzMwr0bRt7/JG+PjALtb6DgX6py7LTvps8+lrWUUqQTvnbqMm
jPe2xf8YLxhm7KAZbu1Y8GHyud5Dxy2aPkZ6++TCmeuqcIsmEBGrTDuyYV++Qt85oKU4sDj6
q+P5b0TNjFv6fj8HxboFUw7df8GrsMK/UXLM/EPZxpHT56+Y914H9eUVs2OL8CnyomHGDpqM
Va7+9lfnUWuGBzoRUYdVnDfHrNx2f3yknbG+k4E+5ZxePSP+pzKlRt9BoKWoUt7bnF7Qa+Hq
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
wg4AAADAQPw/wSelY4qCji8AAAAASUVORK5CYII=&quot; width=&quot;420&quot; height=&quot;420&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Of course, comparing the absolute number of positive predictions will show a high disparity when the number of cases within each group is different, which artificially boosts the disparity. This is true in our case:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ethnicity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea &quot;&gt;
&lt;pre&gt;
       Caucasian African_American            Asian         Hispanic 
             622              962               16              144 
 Native_American            Other 
               4              104 &lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;To address this, we can use proportional parity.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Proportional-parity&quot;&gt;Proportional parity&lt;a class=&quot;anchor-link&quot; href=&quot;#Proportional-parity&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Proportional parity is very similar to demographic parity but modifies it to address the issue discussed above. Proportional parity is achieved if the proportion of positive predictions in the subgroups are close to each other. Similar to the demographic parity, this measure also does not depend on the true labels.&lt;/p&gt;
&lt;p&gt;Formula: &lt;strong&gt;(TP + FP) / (TP + FP + TN + FN)&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_prop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prop_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Caucasian&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_prop&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Proportion&lt;/th&gt;&lt;td&gt;0.2363344&lt;/td&gt;&lt;td&gt;0.5239085&lt;/td&gt;&lt;td&gt;0.1250000&lt;/td&gt;&lt;td&gt;0.1527778&lt;/td&gt;&lt;td&gt;0.250000&lt;/td&gt;&lt;td&gt;0.09615385&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Proportional Parity&lt;/th&gt;&lt;td&gt;1.0000000&lt;/td&gt;&lt;td&gt;2.2168102&lt;/td&gt;&lt;td&gt;0.5289116&lt;/td&gt;&lt;td&gt;0.6464475&lt;/td&gt;&lt;td&gt;1.057823&lt;/td&gt;&lt;td&gt;0.40685505&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_prop&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric_plot&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
/qVtDX979U93/faJjYceeuERny1sk0yE5nfeeO+9Devra1e6k0z14ON26DN94oW1Jx8xoKbj
+cfvnv7YGz84MaqTYQGATiTsukSq9DPfu/T6J35z08N/euzJ397amumzWf/+h3/30kP2+Oyy
bbYbucevb5122vdfveWa01a1n+HnXJW+8Yq7r7v07YUd/TYb+O2LLt+5Kp6fCQIAOlcijg/g
WUHXnWNXXV2dfLA1m822trZ2xf67WSKRKC8vb25uLu4Lof1LnfNXrJqamkwm09ra2tTU1Ck7
LK5kMtm7d+/GxsY4zrGLbDqpVKqurq6hoSGObyKm05PV1tam02nTWV59/Yon8S/jHDsAgEgI
OwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBI
CDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCA
SAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsA
gEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7
AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASJQUewGsfdIjavJtbe2Ls8VeSCdIJpPp3jVN
jR25XK7YawGANeUdOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsAgEgIOwCASAg7AIBICDsA
gEgIOwCASPgnxfjEfv1cyGZTra0VxV5IJ0gkEuXlobm5PJ/PF3stnaC0NJVKhWy2xHR6oE83
nf0+t6TrlgTExzt2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAA
kRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYA
AJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2
AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQ
dgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEQdgAAkRB2AACREHYAAJEoQtidd+QhBx16
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
YPrlg5e/5k+nHX1p039sU95n5Bf6P3zBmDE7DN190Lbb7rHXHkMqPvx49Itb1C67vM3e639w
8yMh7H3wIaPmvj77kSfnzp07Z/aLTy2/t/WHfpiNZYlEWC7KG556LV21U6HqQgjl9V+77LKv
LX/f3r17b7TRRktXXlu7+sF/asuKIY6/CIYQEolETMdSuFCUI+r0P3KJRCKZTOZyuTgGlEwm
C3/YcrlcsdfSCQrT6aKvM93PdHoy01lBLpcrvMe8UsJuTSVSNd+9/IYDZz317POznn3w5puv
veYLh33/jMO2Ldzasdw3pFxbLuTa89lFUyed/ui71UN2HTxwu9333H/IaadcsGybTOkq32jJ
tecSidW9sXT66aeffvrpSzfO5RobG9fowFahuro6hJDNZltbW7ti/90skUiUl5e3tLTEkQ6l
paWpVKpY01mwYEHn7jCZTPbu3XvhwoVxfDWvqanJZDJtbW1NTU0fvXWPl0ql6urqFi5cGMdr
x3R6stra2nQ6bTrLq6+vX9VNfo/dmlr02r03Tb97yx13P+LYky+8fNqPj9nwsbuuXXbrg899
WFd/fPCd8g33bJp3zUMvL7jq6stOO/HIfXffpV/1x/1e2Gdw/7b3n53z75P82pqePuWUU174
oL0TjwUAWKt5x25NlVQv/uVdtzdUVH550Ba5BW/+4Xf/rNz4w59aePnKSXfmj99+w7JXfn/H
zH98MPbnX8ikm/P5Pz742HN7b7vJB2+9OvPq20IIz7/4+o5Dt139A9UOOHmvuscnT7pq/NH7
9840Pzjtysb8kEGVUZ0cBgCsCWG3pio3OuK845pvuPeO829dkK7us+XO+1144iHLbj3n/CPu
uG76XXPn99pk8+PO+dlXN6gIYeTEo9667saf/KqlZPMtBx468aq97p8yY8Z183e59CMeKVEy
/sof3Tzl2p//aNKiXMVnt9/n/JOPTnTtwQEAa5N4ThvvaVoX/eG/jr506p2/2jjzKX/VXMeS
RQtTVfWln+buXXqO3cXvvBvZOXbNzc1xvBCKe47dhL6rPOfj0ymcY9fY2BjTOXatra0xnSfU
0NAQx2vHdHqywjl2prO81Zxj5x27nqukoraTv08CAFHzwxMAAJHwjl1XKa3d6+679yr2KgCA
dYh37AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHs
AAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh
7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAi
IewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAAIiHsAAAiIewAACIh7AAA
IiHsAAAiIewAACIh7AAAIiHsAAAiUVLsBbD2mbzZZ9ra2hYvXlzshXSCZDLZu3fvxsbGXC5X
7LV0gpqamkwm09ra2tTUVOy1AFAE3rEDAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLAD
AIiEsAMAiISwAwCIhLADAIiEsAMAiIR/K5ZPbPLfrstms62trcVeSCdIJBLlC8qbm5vz+Xyx
19IJShtLU6nUqqYzYcOvd/+SAOhO3rEDAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLAD
AIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISw
AwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiE
sAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCI
hLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMA
iISw60L57OJjDh45YsSIhxa0fOTG2ZY5I0aMOP2uuV2/LgAgTsKuCy2Yfc2CjnyfdPI3M+d+
5MaJkpphw4btMaCm69cFAMRJ2HWhx6e9UL7eyJN3rP/n72/IfdTGyZL6sWPHjtqhd3esDACI
UUmxFxCtbOubN85d/LnxX9lqQFv7Kffe8c6SIzasKNz03qwHpt58z2v/eCdR2WfQHsO+fdzI
TCKEEEaPGjloyvQzNqpua3pl2pSbnnzljab2VN9+A/b/+riRu65f2GDEVZe/f9v0WX+fM78p
vdsBY045bEgRjxEA6FGEXVeZ/8S17fmSY4euX5X5xnqZB35/02tHnLlTCKFjyexvn/uzzQ88
5jsnbNM875Vrrr7xvA13vmDYJsvf96YJFz5eMfTYcUduVNX6wmMzb7j4tI0HtiQAACAASURB
VKEzZ/RNJ0MIj/xwyuHjJ47uX9cw+57jzrpk433vOKi+rHCv22+/fdasWYXLFRUV3/ve97ri
uNLpdAghmUyWlpZ2xf6LIpPJFHsJnSOZTIZVT6e6urrbV7RGEolECKGqqiqfzxd7LZ2gpKQk
hJBOp9e6QaxUYTrV1dWm0wNFNp1UKhVCKCkpMZ2C1d9R2HWV+6f/pWrjIzcvS4VQPmarXpc+
c21LfmpZItH2/jOLsrnhB311p9pM2HrLz9T0nVdWtcJ9e3/xoHH7Hfj52kwIYbP+qen3nfu3
lo6+6UwIIbXzSbv3rwsh9Nlm+BblN77w7pJlYffyyy//z//8T+FyXV3dpEmTuu7oEolE4ZUW
h5iOJax6Omtpi0eT3QX+UtSTmU5PlkqlYvpavSbTyWazq7lV2HWJtqZnfvNe85ZjNnvzzTdD
CLX7bpJ9adYNcxafNKC2vM/IL/R/+IIxY3YYuvugbbfdY689hlSs+Cf14ENGzX199iNPzp07
d87sF59a/qb1h6637HJZIhGWq/YBAwbsuuuuhcuVlZXt7e1dcWiF11U+n4/jL4IhhGQymct9
5DmQa4dEIpFIJFY1nS76I9Gl0un02rjslSopKUkkErlcbvVflNciptOTmU5PtobTyeVyq2lc
Ydcl5t03I5/P//n6yeOu//DKp6bNOumivRKpmu9efsOBs5569vlZzz54883XXvOFw75/xmHb
Ltssn100ddLpj75bPWTXwQO3233P/YecdsoFy27NlK7y513GjBkzZsyYwuVcLtfY2Nj5B/bv
j/NyuVxra2tX7L+bJRKJ8vLy1tbWODq1tLQ0lUqtajqLFi3q/iWtiWQy2bt376ampjjKu6am
JpPJtLe3NzU1FXstnSCVStXV1S1evDiO147p9GS1tbWFEjKdZVbz1rKw6xK33v2P6k2PmTFl
1LJrnjjv+P9+/roFHXsm/3rfr59uHf2NUVvuuHsI4a93f2fCLdeecdjly7ZsmnfNQy8vmHbn
tfXpZAihpfHB7l8/ALA28utOOl/Le/c83dQ2+Jv7LH/loOP3zWUXXfNKQ0n14l/eddNldz74
0utzXnjqkft+98/Kjf/jJ1szVVvk8x0PPvbcW/969/VZj/z4rNtCCM+/+HpLFH/xAgC6jnfs
Ot9fbrkvVfaZsVv3Wv7Kyn6H71B110vTnqi84ojzjmu+4d47zr91Qbq6z5Y773fhiYcsv2VZ
n5ETj3rruht/8quWks23HHjoxKv2un/KjBnXzd/l0u49DgBgLZOI4wP4dVPHkkULU1X1pSs5
g7JLz7G7eN70bDYb0zl2zc3NcbwQCufYrWo6Ezb8evcvaU0UzrFrbGyM6Ry71tbWmM4Tamho
iOO1Yzo9WeEcO9NZXn19/apu8o7dWqykonaVgwUA1j3OsQMAiISwAwCIhLADAIiEsAMAiISw
AwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiE
sAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCI
hLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMA
iISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLAD
AIiEsAMAiERJsRfA2mfygOPb2toWL15c7IV0gmQy2bt378bGxlwuV+y1dIKamppMJtPa2trU
1FTstQBQBN6xAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISw
AwCIhLADAIiEfyuWT+yvsyZns9nW1tZiL6QTJBKJxvLy5ubmfD5f7LV0gobS0lQqZTo9U2TT
SSaTDWVlptMzRTadxrKyZDK5Nk6n35YTuv9BvWMHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlh
BwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJ
YQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQ
CWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcA
EAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEHABAJYQcAEAlhBwAQCWEH
ABAJYQcAEIluDbt8dvExB48cMWLEQwtalr9+yT8f+e6J3zj06LNW2D7bMmfEiBGn3zW36Cvs
RN1/UADAOqJbw27B7GsWdOT7pJO/mTl3+ev/fNXN75Ttf+mlE1bYPlFSM2zYsD0G1BR9hZ2o
+w8KAFhHdGvYPT7thfL1Rp68Y/0/f39DbrnrWxvbKjfZfpO+dR9elc++9cb8ZEn92LFjR+3Q
u+gr7BxFOigAYB1R0m2PlG1988a5iz83/itbDWhrP+XeO95ZcsSGFSGE35x4xLR/fhD+cdao
Pw345cyfjB418qArznt80gVzWre7c8ak0aNGDpoy/YyNqnNt82+/8upHX3y1sb18ix33OnHc
0ZuWpUIIbU2vTJty05OvvNHUnurbb8D+Xx83ctf1QwijR40ccdXl7982fdbf58xvSu92wJhT
Dhvy6VYYQjjxkIP2++mP3r3hhlf/Njfba9Mjvztxg9dm/vy3s+a9/d5G23/x3AljKlOJEEI+
u/i+m65+4MlX317Y3m/AoJGjT9z3c3WFxRTroACAdUf3hd38J65tz5ccO3T9qsw31ss88Pub
XjvizJ1CCF+78sbepx07fdMzppy2XWHL+865YujBp54wcKsP75zv+Om48c9W7nryqZPrUgvu
vvqKiRPT0398ZAjhpgkXPl4x9NhxR25U1frCYzNvuPi0oTNn9E0nQwiP/HDK4eMnju5f1zD7
nuPOumTjfe84qL7sU6yw4MGLfjHhonNOrkk9eMk3Lx1/0meHH3fxpcfkFr120vFnXfr88Em7
rBdC+PWk8b9YuNWJJ56xSXWY/fhvrzhzbP5nN35pg4ruOaipU6c+8cQThctVVVVTpkxZw5Gt
VCqVKvy3rGx1T+bapbS0tNhL6BzJZDKYTk8V2XQSiUQwnZ7KdHqIXr16/d8rC9Opra391LvN
5Vb3mWL3hd390/9StfGRm5elQigfs1WvS5+5tiU/tSyRSGVK04lEIllaWpopbJnZ7Yxjhm29
/H2b5l3/yPyOS24dv3VFSQhh0/Mbzr7od++1H1GfTvb+4kHj9jvw87WZEMJm/VPT7zv3by0d
fdOZEEJq55N2718XQuizzfAtym984d0lqw+7Va2wcOt6h4/ZojYTQtjt0E2nPjVr0lFfKEmE
0Otz+/UqffzVRWGX9Voa7r7x5QUX3PqdgZXpEMKArQamnjvq1qmzv3TeLt1zUG+//farr75a
uFxXV1dS0rXDLbzS4hDTsRTEdEQxHUtBTEcU07EUxHREMR1LwVp3RKv5Rrwm36Oz2ezqHvRT
7/cTaWt65jfvNW85ZrM333wzhFC77ybZl2bdMGfxSQNWUqwb7L3hCtc0PPVaumqnQgCFEMrr
v3bZZV8rXD74kFFzX5/9yJNz586dM/vFp5a/1/pD11t2uSyRCPk1WmH1ZpWFC8lMKplevzq1
NPjKkkv3/P68Z/P5/NlHHLz8bitb54WwS/cc1J577rn++usvvamsrLm5eXUH/GllMpkQQj6f
X/0frLVISUlJR0dHsVfROVKpVCKRMJ2eyXR6MtPpydbe6az0G3EikVjD79G5XK6ysnJVt3ZT
2M27b0Y+n//z9ZPHXf/hlU9Nm3XSRXv9343LK1IrXJNrzyUS6f+7ZT67aOqk0x99t3rIroMH
brf7nvsPOe2UC5bdmin9BGn/iVa4UiUV6WSq+rbbpiWWuzKRXLrsbjio/fbbb7/99lu681yu
sbHxY678Eyn8hSmXy7W1tXXF/rtZIpEoKSlpb2/P51cb/muJ0tLSVCplOj1TZNNJJpOm02NF
Np2ysrJEIrE2TueDDz74v1cWPlNesmTJmkyn+GF3693/qN70mBlTRi275onzjv/v569b0LFn
XUliNXcs6DO4f9vMJ+a0ZDdf+rMFT5/x/enHX3JZ//eueejlBdPuvLY+nQwhtDQ+WKwVhhAq
NvhKPvene//VccgmVYVrfnnZJQuGHHvckL7FOigAYJ3SHR9Xt7x3z9NNbYO/uc/yVw46ft9c
dtE1rzR8nD3UDjh5r7r85ElXPfPS63P+/MK0869szG8zqDKdqdoin+948LHn3vrXu6/PeuTH
Z90WQnj+xddbPmEFr/kKQwiZ6sHH7dDnjokXPvz0i3Nee+6u6yff/Nifdxi4khMnu+egAIB1
TXe8Y/eXW+5LlX1m7Nb/kTiV/Q7foequl6Y9Ea4Y/tG7SJSMv/JHN0+59uc/mrQoV/HZ7fc5
/+SjEyGU9Rk58ai3rrvxJ79qKdl8y4GHTrxqr/unzJhx3fxdLu3uFYYQQhh+zlXpG6+4+7pL
317Y0W+zgd++6PKdqzLFOigAYF2TiOMD+I/UsWTRwlRVfemKJ7qtuVzb+43NmfraVQdcl1nN
QXXdOXbV1dX/ePXibDbb2traFfvvZolEory8vLm5OY4XQuE8IdPpmSKbTjKZLJwAbjo9UGTT
KSsrSyaTa+N0+m254j+pFUJIpVJ1dXUNDQ1rMp36+vpV3dR9v+6kuEoqalf5HKyZZKaqvghR
F0JXHhQAsDZaV8IuhPDBOzed/9NXV3pTWa8vTj5zv25eDwBA51qHwq5yw9GXXFLsRQAAdJm1
7Jc4AwCwKsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIO
ACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLC
DgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACAS
wg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAg
EsIOACASwg4AIBLCDgAgEsIOACASJcVeAGufz+4wua2tbfHixcVeSCdIJpO9e/dubGzM5XLF
XksnqKmpyWQyra2tTU1NxV5LJzCdniyVStXV1TU0NOTz+WKvpROYTk9WW1ubTqejmU5X844d
AEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCSEHQBAJIQdAEAkhB0AQCT8
W7F8Yh0P35fPZjOtrcVeSCdIJBId5eXp5uY4/kXFfGlpRyoVTKdHWjqdPfct9kKAmHnHDgAg
EsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4A
IBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIO
ACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLC
DgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACAS
wg4AIBLCDgAgEsIOACASwg4AIBLCDgAgEsIOACASJcVeQHHkc0seuXPG/X946o13G9I1fTf9
7E6HfuPo7TeuKOKSsi1zDjr0tM+OvuKygzcr4jIAgLXXuhh2+WzT1O9963/mlg4/5GsHbfGZ
3OJ3H3/wjsmnPn32dVN3qSst1qoSJTXDhg1bb0BNsRYAAKzt1sWw+/P0Sf8zt+KcqT/doW9Z
4Zqhe+31kzHH/PTcB6dfPqJYq0qW1I8dO7ZYjw4ARGDdC7t8+09+O3ez/7p0WdWFEBLJitGn
HtX7pSWF/21remXalJuefOWNpvZU334D9v/6uJG7rh/y7SMOPPio6+84tL68sNnoUSN3vvKW
8f2qcm3zb7/y6kdffLWxvXyLHfc6cdzRm5alVrmfEN6b9cDUm+957R/vJCr7DNpj2LePG5lJ
LN3hoCnTz9ioelV3HD1q5IirLn//tumz/j5nflN6twPGnHLYkO59+gCAnmudC7vWRX98py37
jX03XOH6PjuNOGanpZdvmnDh4xVDjx135EZVrS88NvOGi08bOnNG31U9VfmOn44b/2zlrief
OrkuteDuq6+YODE9/cdHrmo/vdtf+/a5P9v8wGO+c8I2zfNeuebqG8/bcOcLhm2y/C5XvoB0
MoTwyA+nHD5+4uj+dQ2z7znurEs23veOg+qXFurEiRMfeOCBwuW6urqHH364k56zFXWEkEql
KiqKeUpi5yovLy/2EjqT6fRkpaWlpaVFO+Wj0/Xp06fYS+hMptOTmc4y2Wx2Nbeuc2GXbX0j
hLBZaWo12/T+4kHj9jvw87WZEMJm/VPT7zv3by0dfasSK924ad71j8zvuOTW8VtXlIQQNj2/
4eyLfvde+xH16eRK91PV/MyibG74QV/dqTYTtt7yMzV955VVfawFpDMhhNTOJ+3evy6E0Geb
4VuU3/jCu0uWhR0AsI5b58IuWdInhPBue26F6/P51kWLmstqasuSiYMPGTX39dmPPDl37tw5
s198avU7bHjqtXTVToWqCyGU13/tssu+Vri80v2U9xn5hf4PXzBmzA5Ddx+07bZ77LXHkIoV
K3M1C1h/6HrLLpclEiH/4U0HHnjgTjstfdcxk8m8//77H/10fHJlZWUhhFwu19HR0RX772aJ
RCKdTre3t+fz+Y/euscrKSlJJpOm0zMVptPR0dHS0lLstXSCZDJZUVHxwQcfxDGd8vLyVCpl
Oj2T6awgn89XV1ev6tZ1LuxKe+1dmZr2h6f+NeyA//j0s+HFHx/7g6cmzrhzcEXz1EmnP/pu
9ZBdBw/cbvc99x9y2ikXrGRH+WxzLh9CyLXnEon0ym5ftNL9JFI13738hgNnPfXs87OeffDm
m6+95guHff+Mw7b9yDsWZEpX+asHBw8ePHjw4MLlXC7X2Nj4iZ6ZjymdTqdCyOfzMaVDR0dH
HF/+UqlUMJ2eqjCdbDYbxzenwif+LS0tcUwnk8mkUinT6ZlKS0tNZwXC7kOJVM2pQ9b/4Q2X
vjbkh5/rlVl6bT77q2tml9XtsWt1ZvEbP33o5QXT7ry2Pp0MIbQ0PrjsriGEpo6lY2j+10Mt
uXwIoc/g/m0zn5jTkt186Q9MPH3G96cff8ll/d+7ZqX7WfTavb9+unX0N0ZtuePuIYS/3v2d
Cbdce8Zhly9bYdO8ld8RAGD11rmwCyEMPm3yjiefftYJ4w48bMTnBnwm+cF7f3po5kNvtZ00
5eQQQqZqi3z+jw8+9tze227ywVuvzrz6thDC8y++vuPQbXesyvxxysy9vvXVdNObt075dd9M
KoRQO+DkveoenzzpqvFH79870/zgtCsb80MGVaZbW1a+ny0/s/iXd93eUFH55UFb5Ba8+Yff
/bNy4+HLL281CyjCkwUArD1SkydPLvYaulsyVf2F/fesam145YVnHrrn7qdfmRt6b/vNM8/Z
8zNVIYSSis8NSDX+6he/+NU9//v3+dkDv33Orsl3/ufhR3f68n777Nj75T/eP3Pmb16c+6+9
vnXOhv96vWa3vbetLB385c8veumPv/71Xff+4bmSzff6ztljeqeTq9rPbgefPqSm5Q8P3H/v
3b958sW/Vm77xTMmHF5bkgwh/PqO29f/6qg9199+VQv4/V0z1//qqKE1S38s6Pd3zUzuOXzv
viv5mcF8Pt/c3NwVz15paWnyjb/n8/nV/1TO2mLZh33FXkjnKJzFZTo909LpbLp5W1tbsdfS
CZLJZHl5eRd9nel+yz7sM50eqKyszHRWsJpffZCI4wP4dVPHkkULU1X1K/sJ3647x666ujr1
6P9ms9nW1tau2H83SyQShRdYHC+EZd+cTKcHWjqdPfdtamoq9lo6QSqVqqura2hoiGM6NTU1
mUymtbXVdHqg2tradDptOsurr69f1U3r4kex0SipqF3lYAGAdc8qf8QSAIC1i7ADAIiEsAMA
iISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLAD
AIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISw
AwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiE
sAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCIhLADAIiEsAMAiISwAwCI
hLADAIiEsAMAiISwAwCIREmxF8Dap+TLX821tbUtXlzshXSCZDJZ3bt3e2NjLpcr9lo6QVlN
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
SUVORK5CYII=&quot; width=&quot;420&quot; height=&quot;420&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The proportional parity still shows that African-American defendants are treated unfairly by our model. At the same time, the disparity is lower compared to the one observed with the demographic parity.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;All the remaining fairness metrics account for both model predictions and the true labels.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Equalized-odds&quot;&gt;Equalized odds&lt;a class=&quot;anchor-link&quot; href=&quot;#Equalized-odds&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Equalized odds are achieved if the sensitivities in the subgroups are close to each other. The group-specific sensitivities indicate the number of the true positives divided by the total number of positives in that group.&lt;/p&gt;
&lt;p&gt;Formula: &lt;strong&gt;TP / (TP + FN)&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_eq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;equal_odds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                     &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;African_American&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;res_eq&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Sensitivity&lt;/th&gt;&lt;td&gt;0.6710526&lt;/td&gt;&lt;td&gt;0.8423773&lt;/td&gt;&lt;td&gt;0.9166667&lt;/td&gt;&lt;td&gt;0.9042553&lt;/td&gt;&lt;td&gt;1.000000&lt;/td&gt;&lt;td&gt;0.983871&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Equalized odds&lt;/th&gt;&lt;td&gt;1.0000000&lt;/td&gt;&lt;td&gt;1.2553073&lt;/td&gt;&lt;td&gt;1.3660131&lt;/td&gt;&lt;td&gt;1.3475177&lt;/td&gt;&lt;td&gt;1.490196&lt;/td&gt;&lt;td&gt;1.466161&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Accuracy-parity&quot;&gt;Accuracy parity&lt;a class=&quot;anchor-link&quot; href=&quot;#Accuracy-parity&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Accuracy parity is achieved if the accuracies (all accurately classified examples divided by the total number of examples) in the subgroups are close to each other.&lt;/p&gt;
&lt;p&gt;Formula: &lt;strong&gt;(TP + TN) / (TP + FP + TN + FN)&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acc_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;African_American&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_acc&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Accuracy&lt;/th&gt;&lt;td&gt;0.6860707&lt;/td&gt;&lt;td&gt;0.6623794&lt;/td&gt;&lt;td&gt;0.750000&lt;/td&gt;&lt;td&gt;0.6805556&lt;/td&gt;&lt;td&gt;0.750000&lt;/td&gt;&lt;td&gt;0.6730769&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Accuracy Parity&lt;/th&gt;&lt;td&gt;1.0000000&lt;/td&gt;&lt;td&gt;0.9654682&lt;/td&gt;&lt;td&gt;1.093182&lt;/td&gt;&lt;td&gt;0.9919613&lt;/td&gt;&lt;td&gt;1.093182&lt;/td&gt;&lt;td&gt;0.9810606&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;False-negative-rate-parity&quot;&gt;False negative rate parity&lt;a class=&quot;anchor-link&quot; href=&quot;#False-negative-rate-parity&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;False negative rate parity is achieved if the false negative rates (the ratio between the number of false negatives and the total number of positives) in the subgroups are close to each other.&lt;/p&gt;
&lt;p&gt;Formula: &lt;strong&gt;FN / (TP + FN)&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_fnr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fnr_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;African_American&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_fnr&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;FNR&lt;/th&gt;&lt;td&gt;0.3289474&lt;/td&gt;&lt;td&gt;0.1576227&lt;/td&gt;&lt;td&gt;0.08333333&lt;/td&gt;&lt;td&gt;0.09574468&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;0.01612903&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;FNR Parity&lt;/th&gt;&lt;td&gt;1.0000000&lt;/td&gt;&lt;td&gt;0.4791731&lt;/td&gt;&lt;td&gt;0.25333333&lt;/td&gt;&lt;td&gt;0.29106383&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;0.04903226&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;False-positive-rate-parity&quot;&gt;False positive rate parity&lt;a class=&quot;anchor-link&quot; href=&quot;#False-positive-rate-parity&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;False positive rate parity is achieved if the false positive rates (the ratio between the number of false positives and the total number of negatives) in the subgroups are close to each other.&lt;/p&gt;
&lt;p&gt;Formula: &lt;strong&gt;FP / (TN + FP)&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_fpr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fpr_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;African_American&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_fpr&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;FPR&lt;/th&gt;&lt;td&gt;0.3003953&lt;/td&gt;&lt;td&gt;0.6340426&lt;/td&gt;&lt;td&gt;0.750000&lt;/td&gt;&lt;td&gt;0.740000&lt;/td&gt;&lt;td&gt;0.500000&lt;/td&gt;&lt;td&gt;0.7857143&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;FPR Parity&lt;/th&gt;&lt;td&gt;1.0000000&lt;/td&gt;&lt;td&gt;2.1106943&lt;/td&gt;&lt;td&gt;2.496711&lt;/td&gt;&lt;td&gt;2.463421&lt;/td&gt;&lt;td&gt;1.664474&lt;/td&gt;&lt;td&gt;2.6156015&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Negative-predictive-value-parity&quot;&gt;Negative predictive value parity&lt;a class=&quot;anchor-link&quot; href=&quot;#Negative-predictive-value-parity&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Negative predictive value parity is achieved if the negative predictive values in the subgroups are close to each other. The negative predictive value is computed as a ratio between the number of true negatives and the total number of predicted negatives. This function can be considered the ‘inverse’ of the predictive rate parity.&lt;/p&gt;
&lt;p&gt;Formula: &lt;strong&gt;TN / (TN + FN)&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_npv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;npv_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;African_American&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_npv&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;NPV&lt;/th&gt;&lt;td&gt;0.702381&lt;/td&gt;&lt;td&gt;0.5850340&lt;/td&gt;&lt;td&gt;0.5000000&lt;/td&gt;&lt;td&gt;0.5909091&lt;/td&gt;&lt;td&gt;1.000000&lt;/td&gt;&lt;td&gt;0.900000&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;NPV Parity&lt;/th&gt;&lt;td&gt;1.000000&lt;/td&gt;&lt;td&gt;0.8329298&lt;/td&gt;&lt;td&gt;0.7118644&lt;/td&gt;&lt;td&gt;0.8412943&lt;/td&gt;&lt;td&gt;1.423729&lt;/td&gt;&lt;td&gt;1.281356&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Specificity-parity&quot;&gt;Specificity parity&lt;a class=&quot;anchor-link&quot; href=&quot;#Specificity-parity&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Specificity parity is achieved if the specificities (the ratio of the number of the true negatives and the total number of negatives) in the subgroups are close to each other. This function can be considered the ‘inverse’ of the equalized odds.&lt;/p&gt;
&lt;p&gt;Formula: &lt;strong&gt;TN / (TN + FP)&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_sp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spec_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ethnicity&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;African_American&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_sp&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 6 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;African_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Caucasian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Asian&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Hispanic&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Native_American&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Other&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Specificity&lt;/th&gt;&lt;td&gt;0.6996047&lt;/td&gt;&lt;td&gt;0.3659574&lt;/td&gt;&lt;td&gt;0.2500000&lt;/td&gt;&lt;td&gt;0.2600000&lt;/td&gt;&lt;td&gt;0.5000000&lt;/td&gt;&lt;td&gt;0.2142857&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;Specificity Parity&lt;/th&gt;&lt;td&gt;1.0000000&lt;/td&gt;&lt;td&gt;0.5230917&lt;/td&gt;&lt;td&gt;0.3573446&lt;/td&gt;&lt;td&gt;0.3716384&lt;/td&gt;&lt;td&gt;0.7146893&lt;/td&gt;&lt;td&gt;0.3062954&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Apart from the parity-based metrics presented above, two additional comparisons are implemented: ROC AUC comparison and Matthews correlation coefficient comparison.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;ROC-AUC-comparison&quot;&gt;ROC AUC comparison&lt;a class=&quot;anchor-link&quot; href=&quot;#ROC-AUC-comparison&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;This function calculates ROC AUC and visualizes ROC curves for all subgroups. Note that probabilities must be defined for this function. Also, as ROC evaluates all possible cutoffs, the cutoff argument is excluded from this function.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_auc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roc_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Female&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Male&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_auc&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Setting direction: controls &amp;lt; cases

Setting direction: controls &amp;lt; cases

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 2 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Male&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Female&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;ROC AUC&lt;/th&gt;&lt;td&gt;0.7221429&lt;/td&gt;&lt;td&gt;0.7192349&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;ROC AUC Parity&lt;/th&gt;&lt;td&gt;1.0000000&lt;/td&gt;&lt;td&gt;0.9959731&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Apart from the standard outputs, the function also returns ROC curves for each of the subgroups:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_auc&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ROCAUC_plot&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
3YduJaU1mfVNmPulv+IrNq3uX7gnBmfC6HXqbRsZg16UK3Sde4hqta1aPpWjO5yVQ0SjAvwU
WA3rOE6cOPHpp58SUd26dZcvX86gqxUACmV7WvqPaUU9armTr1dnXx9rruQNd44ePfrkPa++
1kzO0KK3QmcnNl66JKa2P3Nk67L+zauJcff7VvEiojWdZ286+PPqQNmarjXC6tV6ZdTC30/N
45OO16z4Rvivo3a1L09EE157f6t3l4VrP6/uo9u/Zdb4Lg27ZKVUVD7eMiKf9l+U9YWduHpA
yyGRfzx82MRFH+i3N6s5u+XItXsX98dpsS5NFFU//8imaYhhDO90FAJL2bDteUmpRFRWLvvI
19uGzYJd3b17t0+fPkajsVSpUtHR0W5utlkZDQAu6LLesD2tqMsLaqqVVl6Znbjh9dc3PHlP
gpH3SFo6/vcH+zXft/JRElHDJi1lvwbOGHq47972RFR++vxGpdRE1GlK3SE79v08q4eCISrd
dGCQ+5ZjydS+PBGV7T1u7cDR7weqiSi0vmzKinfPZBkrKh92gmTdX5xP+y/K2sLu+nddhkT+
0XL40uWf9nypYiAReZQZtuzTv0fMG9C9aattPSoX4rnBOSgPH5DduEpEhibNTTVq27DlmLSM
Q1nZRDQywE+BLh8HkZWVFRYWlpqaqlQqN2zYEBxsg6PkAMBl1VQprexsy78RK6/0Kj8t4/bn
ee68d3m3KAqtfVVP3umTfZmoPRH513sYj1PLZMpKfo/6utxZhoSHF0+YNP78ycMx28+fP//3
kQM78rSfnm/7L8rawm7euH0+1cce+GZk7rcrqyg7/KtdwsGgSaOmU4+YQjw3OAHFXycUJ48S
kblKdWMzW044vaw3TE5IJKIGalVvv6L+rYbiIQjC0KFDL126RERfffXVK6+8InUiAHBsnX19
il7YFZHcS8XJ/dPSbj85eZxhrd2SUzAlDW3b6Pub/p3fa9+qRbeegz9oWK+jDdvPw9oZ7ttT
dFX7Rfy3z6RVzwq61J2Fe25wdPKzp5SH9hERH1ha374z2a5TzSCKQ+4l6ATRnWVXlisjR3ed
g5g1a9aePXuIaOTIkWFhYVLHAQCwAe8qAwWzZvlto/sjywf3nro73sqHay6PWvv7gwuXT21Y
+kWfbu9W939g2/bzsLawC5CzWVefMXsxI07LKcsW7rnBocn//Vu1fw+JouDnr+sWJiqt7ei2
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&quot; width=&quot;420&quot; height=&quot;420&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Matthews-correlation-coefficient-comparison&quot;&gt;Matthews correlation coefficient comparison&lt;a class=&quot;anchor-link&quot; href=&quot;#Matthews-correlation-coefficient-comparison&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The Matthews correlation coefficient (MCC) takes all four classes of the confusion matrix into consideration. &lt;a href=&quot;https://en.wikipedia.org/wiki/Matthews_correlation_coefficient&quot;&gt;MCC&lt;/a&gt; is sometimes referred to as the single most powerful metric in binary classification problems, especially for data with class imbalances.&lt;/p&gt;
&lt;p&gt;Formula: &lt;strong&gt;(TP×TN-FP×FN)/√((TP+FP)×(TP+FN)×(TN+FP)×(TN+FN))&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_mcc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mcc_parity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;outcome&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Two_yr_Recidivism&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Female&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prob_1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;preds_levels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;no&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;yes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;cutoff&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Male&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;res_mcc&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Metric&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table class=&quot;dataframe&quot;&gt;
&lt;caption&gt;A matrix: 2 × 2 of type dbl&lt;/caption&gt;
&lt;thead&gt;
	&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Male&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;Female&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;MCC&lt;/th&gt;&lt;td&gt;0.3316558&lt;/td&gt;&lt;td&gt;0.2893650&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;MCC Parity&lt;/th&gt;&lt;td&gt;1.0000000&lt;/td&gt;&lt;td&gt;0.8724859&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;6.-Closing-words&quot;&gt;6. Closing words&lt;a class=&quot;anchor-link&quot; href=&quot;#6.-Closing-words&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;You have read through the fairness R package tutorial! By now, you should have a solid grip on algorithmic group fairness metrics.&lt;/p&gt;
&lt;p&gt;We hope that you will be able to use the R package in your data analysis! Please let me know if you run into any issues while working with the package in the comment window below or on &lt;a href=&quot;https://github.com/kozodoi/fairness&quot;&gt;GitHub&lt;/a&gt;. Please also feel free to contact the authors if you have any feedback.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Acknowlegments:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Calders, T., &amp;amp; Verwer, S. (2010). Three naive Bayes approaches for discrimination-free classification. Data Mining and Knowledge Discovery, 21(2), 277-292.&lt;/li&gt;
&lt;li&gt;Chouldechova, A. (2017). Fair prediction with disparate impact: A study of bias in recidivism prediction instruments. Big data, 5(2), 153-163.&lt;/li&gt;
&lt;li&gt;Feldman, M., Friedler, S. A., Moeller, J., Scheidegger, C., &amp;amp; Venkatasubramanian, S. (2015, August). Certifying and removing disparate impact. In Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining (pp. 259-268). ACM.&lt;/li&gt;
&lt;li&gt;Friedler, S. A., Scheidegger, C., Venkatasubramanian, S., Choudhary, S., Hamilton, E. P., &amp;amp; Roth, D. (2018). A comparative study of fairness-enhancing interventions in machine learning. arXiv preprint arXiv:1802.04422.&lt;/li&gt;
&lt;li&gt;Zafar, M. B., Valera, I., Gomez Rodriguez, M., &amp;amp; Gummadi, K. P. (2017, April). Fairness beyond disparate treatment &amp;amp; disparate impact: Learning classification without disparate mistreatment. In Proceedings of the 26th International Conference on World Wide Web (pp. 1171-1180). International World Wide Web Conferences Steering Committee.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Nikita Kozodoi, Tibor V. Varga</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://kozodoi.me/images/posts/fairness.png" /><media:content medium="image" url="https://kozodoi.me/images/posts/fairness.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>